import{d as ee,b as p,o as se,f as l,g as r,i as e,p as T,l as R,t as n,F as z,k as K,m as te,v as we,G as ye,H as _e,_ as ae,u as ke,a as De,h as Z,j as H,A as Ie,s as I,K as Te,w as Re}from"./index-DFO3eZqt.js";import"./request-DzKJqaQU.js";import{useChatHistoryStore as $e}from"./chatHistory-wuOurKui.js";const Ce={class:"dify-chat-widget"},Se={class:"chat-container"},xe={class:"chat-header"},Ae={class:"ai-avatar-section"},Ue={class:"ai-avatar-circle"},Oe={class:"ai-info-section"},We={class:"connection-status"},Me={class:"status-text"},Ne={key:0,class:"message-avatar"},qe={class:"message-content"},Pe=["innerHTML"],Ee={class:"message-time"},je={key:0,class:"message assistant typing-indicator"},Ve={class:"chat-input"},Be={class:"input-container"},Le=["disabled"],ze=["disabled"],Ke=ee({__name:"DifyChatWidgetNew",props:{containerId:{default:"dify-chat-container"},autoLoad:{type:Boolean,default:!0}},emits:["loaded","error","message"],setup(J,{expose:S,emit:F}){const Y=J,q=F,g=p([]),U=p(""),x=p(!1),f=p(!1),h=p(""),y=p(null),c={apiKey:"app-oaUwvb7k2zbC8Bi03EO977nN",baseUrl:"http://4295a4ce.r28.cpolar.top/v1",chatUrl:"http://4295a4ce.r28.cpolar.top/v1/chat-messages"},k=async()=>{try{console.log("æ­£åœ¨è¿æ¥DifyæœåŠ¡..."),console.log("ä½¿ç”¨API Key:",c.apiKey),console.log("Base URL:",c.baseUrl);const d=await fetch(`${c.baseUrl}/parameters`,{method:"GET",headers:{Authorization:`Bearer ${c.apiKey}`,"Content-Type":"application/json"}});if(console.log("åŸºç¡€è¿æ¥æµ‹è¯•çŠ¶æ€:",d.status),d.ok){const i=await fetch(c.chatUrl,{method:"POST",headers:{Authorization:`Bearer ${c.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:{},query:"hello",response_mode:"blocking",user:"test-user"})});if(console.log("èŠå¤©APIæµ‹è¯•çŠ¶æ€:",i.status),i.ok)f.value=!0,console.log("ğŸ‰ DifyæœåŠ¡è¿æ¥æˆåŠŸï¼èŠå¤©APIæ­£å¸¸å·¥ä½œ"),j(),q("loaded");else{console.error("èŠå¤©APIæµ‹è¯•å¤±è´¥:",i.status);const m=await i.text();throw console.error("èŠå¤©APIé”™è¯¯è¯¦æƒ…:",m),new Error(`èŠå¤©APIé”™è¯¯: ${i.status}`)}}else throw console.error("åŸºç¡€è¿æ¥å¤±è´¥:",d.status),new Error(`åŸºç¡€è¿æ¥å¤±è´¥: ${d.status}`)}catch(d){console.error("Difyè¿æ¥å¤±è´¥:",d),f.value=!1,q("error",`æ— æ³•è¿æ¥åˆ°DifyæœåŠ¡: ${d instanceof Error?d.message:String(d)}`),console.log("Difyè¿æ¥å¤±è´¥ï¼Œä½†ä»å¯ä½¿ç”¨åŸºæœ¬åŠŸèƒ½"),j()}},j=()=>{const d={id:Date.now(),type:"assistant",content:"æ‚¨å¥½ï¼æˆ‘æ˜¯æ™®æ™®AIåŠ©æ‰‹ï¼Œæ‚¨çš„ä¸“å±é€‰æˆ¿é¡¾é—®ã€‚æˆ‘å¯ä»¥æ ¹æ®æ‚¨çš„éœ€æ±‚ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„æˆ¿é—´ã€‚è¯·å‘Šè¯‰æˆ‘æ‚¨çš„éœ€æ±‚ï¼Œæ¯”å¦‚é¢„ç®—ã€æˆ¿å‹åå¥½ç­‰ã€‚",timestamp:new Date().toISOString()};g.value.push(d),O()},M=()=>{console.log("é‡ç½®ä¼šè¯ï¼Œæ¸…ç©ºèŠå¤©å†å²å’Œä¼šè¯ID"),h.value="",g.value=[],j()},N=async()=>{if(!U.value.trim()||!f.value||x.value)return;const d=U.value.trim(),i={id:Date.now(),type:"user",content:d,timestamp:new Date().toISOString()};g.value.push(i),U.value="",O(),x.value=!0;try{if(console.log("å‘é€æ¶ˆæ¯åˆ°Dify:",d),!f.value)throw new Error("DifyæœåŠ¡æœªè¿æ¥");const m={inputs:{},query:d,response_mode:"blocking",user:"user-"+Date.now()};h.value&&h.value.trim()?(m.conversation_id=h.value,console.log("ä½¿ç”¨ç°æœ‰ä¼šè¯ID:",h.value)):console.log("å¼€å§‹æ–°ä¼šè¯ï¼ˆæ— ä¼šè¯IDï¼‰"),console.log("å‘é€è¯·æ±‚ä½“:",JSON.stringify(m,null,2));const w=await fetch(c.chatUrl,{method:"POST",headers:{Authorization:`Bearer ${c.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify(m)});if(console.log("Dify APIå“åº”çŠ¶æ€:",w.status),w.ok){const $=await w.json();console.log("Difyå“åº”æ•°æ®:",$),$.conversation_id&&(h.value=$.conversation_id);const C={id:Date.now()+1,type:"assistant",content:$.answer||"æŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰ç†è§£æ‚¨çš„é—®é¢˜ï¼Œè¯·é‡æ–°æè¿°ã€‚",timestamp:new Date().toISOString()};g.value.push(C),q("message",{type:"ai",content:C.content,timestamp:C.timestamp})}else{const $=await w.text();if(console.error(`Dify APIè°ƒç”¨å¤±è´¥ (${w.status}):`,$),w.status===404&&$.includes("Conversation Not Exists")){console.log("ä¼šè¯ä¸å­˜åœ¨ï¼Œé‡ç½®ä¼šè¯IDå¹¶é‡è¯•"),h.value="";try{const E=await fetch(c.chatUrl,{method:"POST",headers:{Authorization:`Bearer ${c.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:{},query:d,response_mode:"blocking",user:"user-"+Date.now()})});if(E.ok){const W=await E.json();console.log("é‡è¯•æˆåŠŸï¼ŒDifyå“åº”æ•°æ®:",W),W.conversation_id&&(h.value=W.conversation_id,console.log("æ–°ä¼šè¯ID:",h.value));const B={id:Date.now()+1,type:"assistant",content:W.answer||"æŠ±æ­‰ï¼Œæˆ‘æ²¡æœ‰ç†è§£æ‚¨çš„é—®é¢˜ï¼Œè¯·é‡æ–°æè¿°ã€‚",timestamp:new Date().toISOString()};g.value.push(B),q("message",{type:"ai",content:B.content,timestamp:B.timestamp});return}}catch(E){console.error("é‡è¯•å¤±è´¥:",E)}}const C={id:Date.now()+1,type:"assistant",content:`æŠ±æ­‰ï¼ŒAIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼ˆé”™è¯¯ä»£ç ï¼š${w.status}ï¼‰ã€‚è¯·ç¨åå†è¯•æˆ–è”ç³»ç®¡ç†å‘˜ã€‚`,timestamp:new Date().toISOString()};g.value.push(C)}}catch(m){console.error("å‘é€æ¶ˆæ¯å¤±è´¥:",m);const w={id:Date.now()+1,type:"assistant",content:`æŠ±æ­‰ï¼Œå‘é€æ¶ˆæ¯æ—¶å‡ºç°é”™è¯¯ï¼š${m instanceof Error?m.message:String(m)}ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åå†è¯•ã€‚`,timestamp:new Date().toISOString()};g.value.push(w)}finally{x.value=!1,O()}},O=()=>{_e(()=>{y.value&&(y.value.scrollTop=y.value.scrollHeight)})},V=d=>new Date(d).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),P=d=>{if(!d)return"";console.log("åŸå§‹æ¶ˆæ¯å†…å®¹:",d);let i=d.replace(/ğŸ  æŸ¥çœ‹æˆ¿å‹"[^>]*>ğŸ  æŸ¥çœ‹æˆ¿å‹/g,"").replace(/- ğŸ  æŸ¥çœ‹æˆ¿å‹"[^>]*>ğŸ  æŸ¥çœ‹æˆ¿å‹/g,"").replace(/æŸ¥çœ‹æˆ¿å‹"[^>]*>ğŸ  æŸ¥çœ‹æˆ¿å‹/g,"").replace(/æŸ¥çœ‹æˆ¿å‹"[^>]*>æŸ¥çœ‹æˆ¿å‹/g,"").replace(/æŸ¥çœ‹æˆ¿é—´"[^>]*>æŸ¥çœ‹æˆ¿é—´/g,"").replace(/æŸ¥çœ‹è¯¦æƒ…"[^>]*>æŸ¥çœ‹è¯¦æƒ…/g,"").replace(/[^<]*" target="_blank"[^>]*>[^<]*/g,"").replace(/[^<]*rel="noopener noreferrer"[^>]*>[^<]*/g,"").replace(/[^<]*class="message-link"[^>]*>[^<]*/g,"");return console.log("æ¸…ç†åå†…å®¹:",i),i=i.replace(/(ğŸ’°\d+å…ƒ\/æ™š)/g,`$1
<a href="https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00" target="_blank" rel="noopener noreferrer" class="message-link">ğŸ  æŸ¥çœ‹æˆ¿å‹</a>`),i=i.replace(/æŸ¥çœ‹æˆ¿é—´[ï¼š:]\s*\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="message-link">ğŸ  æŸ¥çœ‹æˆ¿å‹</a>'),i=i.replace(/\[([^\]]+)\]\(([^)]+)\)/g,(m,w,$)=>{let C="ğŸ  æŸ¥çœ‹æˆ¿å‹";return(w==="book now"||w==="Book Now"||w==="ç«‹å³é¢„è®¢")&&(C="ğŸ“ ç«‹å³é¢„è®¢"),console.log(`é“¾æ¥è½¬æ¢: "${w}" â†’ "${C}"`),`<a href="${$}" target="_blank" rel="noopener noreferrer" class="message-link">${C}</a>`}),i=i.replace(/(https?:\/\/[^\s<>"']+)/g,'<a href="$1" target="_blank" rel="noopener noreferrer" class="message-link">ğŸ  æŸ¥çœ‹æˆ¿å‹</a>'),i=i.replace(/\n\s*\n/g,`
`),i=i.replace(/\n/g,"<br>"),console.log("æœ€ç»ˆæ ¼å¼åŒ–å†…å®¹:",i),i};return se(()=>{Y.autoLoad&&setTimeout(()=>{k()},1e3)}),S({initializeDify:k,isDifyConnected:()=>f.value,sendMessage:N}),(d,i)=>(r(),l("div",Ce,[e("div",Se,[e("div",xe,[e("div",Ae,[e("div",Ue,[i[1]||(i[1]=e("video",{src:"/src/assets/images/IPå½¢è±¡/37b48b40dbc80e2a44dce0f626120357_raw.mp4",alt:"æ™®æ™®AIåŠ©æ‰‹",class:"ai-character-video",autoplay:"",loop:"",muted:"",playsinline:""},null,-1)),e("div",{class:T(["status-indicator",{online:f.value}])},null,2)]),e("div",Oe,[i[2]||(i[2]=e("h3",{class:"ai-name"},"æ™®æ™® AIåŠ©æ‰‹",-1)),i[3]||(i[3]=e("p",{class:"ai-title"},"ä¸“å±é€‰æˆ¿é¡¾é—®",-1)),e("div",We,[e("span",{class:T(["status-dot",{online:f.value}])},null,2),e("span",Me,n(f.value?"åœ¨çº¿":"è¿æ¥ä¸­..."),1),f.value?R("",!0):(r(),l("button",{key:0,onClick:k,class:"reconnect-btn"}," é‡æ–°è¿æ¥ ")),f.value&&h.value?(r(),l("button",{key:1,onClick:M,class:"reset-btn"}," æ–°å¯¹è¯ ")):R("",!0)])])])]),e("div",{class:"chat-messages",ref_key:"chatMessages",ref:y},[(r(!0),l(z,null,K(g.value,m=>(r(),l("div",{key:m.id,class:T(["message",m.type])},[m.type==="assistant"?(r(),l("div",Ne,i[4]||(i[4]=[e("video",{src:"/src/assets/images/IPå½¢è±¡/37b48b40dbc80e2a44dce0f626120357_raw.mp4",class:"avatar-video",autoplay:"",loop:"",muted:"",playsinline:""},null,-1)]))):R("",!0),e("div",qe,[e("div",{class:"message-text",innerHTML:P(m.content)},null,8,Pe),e("div",Ee,n(V(m.timestamp)),1)])],2))),128)),x.value?(r(),l("div",je,i[5]||(i[5]=[e("div",{class:"message-avatar"},[e("video",{src:"/src/assets/images/IPå½¢è±¡/37b48b40dbc80e2a44dce0f626120357_raw.mp4",class:"avatar-video",autoplay:"",loop:"",muted:"",playsinline:""})],-1),e("div",{class:"message-content"},[e("div",{class:"typing-dots"},[e("span"),e("span"),e("span")])],-1)]))):R("",!0)],512),e("div",Ve,[e("div",Be,[te(e("input",{"onUpdate:modelValue":i[0]||(i[0]=m=>U.value=m),onKeypress:ye(N,["enter"]),placeholder:"è¯·è¾“å…¥æ‚¨çš„éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šæ¨èä¾¿å®œçš„æˆ¿é—´...",class:"message-input",disabled:!f.value||x.value},null,40,Le),[[we,U.value]]),e("button",{onClick:N,class:"send-button",disabled:!U.value.trim()||!f.value||x.value},i[6]||(i[6]=[e("i",{class:"fas fa-paper-plane"},null,-1)]),8,ze)])])])]))}}),Fe=ae(Ke,[["__scopeId","data-v-6e22ad4c"]]),Ye={class:"ai-room-selection"},He={class:"main-content"},Je={class:"container"},Ge={class:"content-grid"},Qe={class:"left-panel"},Xe={class:"ai-assistant"},Ze={class:"ai-header"},es={class:"ai-avatar"},ss=["src"],ts={key:0,class:"speaking-indicator"},as={class:"ai-info"},os={class:"ai-status"},is={class:"ai-controls"},ns={class:"control-buttons"},ls=["disabled"],rs={key:0,class:"fas fa-microphone"},cs={key:1,class:"fas fa-stop"},ds=["disabled"],us={key:0,class:"voice-indicator"},ps={key:1,class:"voice-result"},fs={class:"voice-content"},ms={class:"recommended-rooms"},hs={key:0,class:"count"},vs={class:"rooms-list"},gs={key:0,class:"empty-state"},bs={key:1,class:"rooms-container"},ws=["onClick"],ys=["src","alt"],_s={class:"room-info"},ks={key:0,class:"recommend-reason"},Ds={class:"room-meta"},Is={class:"price"},Ts={class:"rating"},Rs={key:0,class:"scroll-indicators"},$s=["onClick"],Cs={class:"order-details"},Ss={key:0,class:"order-status"},xs={class:"order-content"},As={key:0,class:"order-info"},Us={class:"order-header"},Os={class:"order-number"},Ws={class:"value"},Ms={class:"order-date"},Ns={class:"value"},qs={class:"order-room-info"},Ps={class:"room-image-container"},Es=["src"],js={class:"room-details"},Vs={class:"stay-dates"},Bs={class:"date-item"},Ls={class:"date-item"},zs={class:"guest-info"},Ks={class:"guest-item"},Fs={class:"value"},Ys={class:"guest-item"},Hs={class:"value"},Js={class:"order-summary"},Gs={class:"summary-item"},Qs={class:"value"},Xs={class:"summary-item total"},Zs={class:"value price"},et={key:1,class:"empty-state"},st={class:"right-panel"},tt={class:"chat-container"},at={class:"chat-header"},ot={class:"chat-status"},it={class:"dify-chat-wrapper"},nt={class:"all-rooms-section"},lt={class:"section-header"},rt={class:"room-filters"},ct={class:"view-toggle"},dt={class:"rooms-content"},ut={key:0,class:"loading-state"},pt={key:1,class:"empty-state"},ft=["onClick"],mt={class:"room-image-container"},ht=["src","alt"],vt={class:"room-price-badge"},gt={class:"room-details"},bt={class:"room-header"},wt={class:"room-name"},yt={key:0,class:"room-rating"},_t={class:"room-type"},kt={class:"room-features"},Dt={key:0,class:"feature"},It={class:"feature"},Tt={key:1,class:"feature"},Rt=["href"],$t={class:"room-footer"},Ct={class:"room-category"},St=["disabled","onClick"],xt=ee({__name:"AIRoomSelectionView",setup(J){ke(),De(),$e();const S=p(!1),F=p(!1),Y=p("idle"),q=p("/src/assets/images/IPå½¢è±¡/37b48b40dbc80e2a44dce0f626120357_raw.mp4"),g=p([]),U=p(0),x=p(),f=p(!1),h=p(""),y=p(null),c=p(null);p([]);const k=[{id:"107",code:"107",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆå•äººé—´ï¼‰",price:456,rating:4.8,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”1.jpg",floor:"1æ¥¼",direction:"å—å‘å¸¦é˜³å°",type:"å•äººé—´",features:["å—å‘é˜³å°","èŒ¶å›­æ™¯è§‚"]},{id:"108",code:"108",name:"1æ¥¼èŒ¶å›­æˆ¿",price:156,rating:4.6,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”1.jpg",floor:"1æ¥¼",direction:"å—å‘é˜³å…‰",type:"å•äººé—´",features:["æ€§ä»·æ¯”ä¹‹é€‰","èŒ¶å›­æ™¯è§‚"]},{id:"201",code:"201",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆå•äººé—´ï¼‰",price:268,rating:4.7,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"å—å‘å¸¦é˜³å°",type:"å•äººé—´",features:["å—å‘é˜³å°","é›¨æ—æ™¯è§‚"]},{id:"202",code:"202",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",price:486,rating:4.9,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"å—å‘é‡‡å…‰",type:"åŒäººé—´",features:["å«åŒæ—©","èŒ¶å›­æ™¯è§‚"]},{id:"204",code:"204",name:"å±±æ™¯é˜³å°å—å‘æˆ¿",price:999,rating:4.9,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"å—å‘é˜³å°",type:"åŒäººé—´",features:["å«åŒæ—©","ç‰¹è‰²å±±æ™¯é˜³å°","é›¨æ—æ™¯è§‚"]},{id:"206",code:"206",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",price:654,rating:4.8,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"è¥¿å‘è§‚æ™¯",type:"åŒäººé—´",features:["å«åŒæ—©","é…èŒ¶å…·å¥—è£…"]},{id:"207",code:"207",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆåŒäººé—´ï¼‰",price:186,rating:4.7,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"ä¸œå‘å¸¦é˜³å°",type:"åŒäººé—´",features:["ä¸œå‘é˜³å°","é›¨æ—æ™¯è§‚"]},{id:"208",code:"208",name:"èŒ¶å›­æ™¯è§‚åŒ—å‘æˆ¿",price:198,rating:4.6,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”2.jpg",floor:"2æ¥¼",direction:"åŒ—å‘",type:"å•äººé—´",features:["å±±æ™¯é˜³å°","æ—©é¤","èŒ¶å›­æ™¯è§‚"]},{id:"301",code:"301",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆåŒäººé—´ï¼‰",price:486,rating:4.8,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”3.jpg",floor:"3æ¥¼",direction:"å—å‘",type:"åŒäººé—´",features:["èŒ¶å…·å¥—è£…","å«æ—©é¤","èŒ¶å›­æ™¯è§‚"]},{id:"302",code:"302",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆåŒäººé—´ï¼‰",price:688,rating:4.8,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”3.jpg",floor:"3æ¥¼",direction:"å—å‘",type:"åŒäººé—´",features:["èŒ¶å›­æ™¯è§‚","é›¨æ—æ™¯è§‚"]},{id:"303",code:"303",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹ï¼ˆäº²å­æˆ¿ï¼‰",price:1088,rating:4.9,status:"available",image:"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”3.jpg",floor:"3æ¥¼",direction:"å—å‘",type:"äº²å­æˆ¿",features:["å±±æ™¯é˜³å°","å«æ—©é¤","é€‚åˆå®¶åº­"]}],j=p(),M=p(),N=p([]),O=p([]),V=p(!1),P=p("all"),d=p("grid");se(()=>{i(),m(),G()});const i=()=>{console.log("AIåŠ©æ‰‹åˆå§‹åŒ–å®Œæˆï¼Œä½¿ç”¨Difyç»„ä»¶")},m=async()=>{await w()},w=async()=>{V.value=!0;try{const a=[{id:1,code:"å±•è§ˆå…",name:"å±•è§ˆå…",category:"å±•è§ˆå…",floor:"1æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"å±•è§ˆå…",price:0,seat:0,rating:0,status:"unavailable",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",vrUrl:"",recommendReason:"å±•è§ˆå…æš‚ä¸å¼€æ”¾é¢„è®¢"},{id:2,code:"105",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"å•äººé—´",price:256,seat:1,rating:4.5,status:"available",image:"https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"é›¨æ—æ™¯è§‚ï¼Œç¯å¢ƒä¼˜ç¾ï¼Œé€‚åˆç‹¬è‡ªæ—…è¡Œ"},{id:3,code:"104",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"å•äººé—´",price:255,seat:1,rating:4.5,status:"available",image:"https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"æ€§ä»·æ¯”é«˜ï¼Œç¯å¢ƒèˆ’é€‚"},{id:4,code:"103",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"å•äººé—´",price:333,seat:1,rating:4.6,status:"available",image:"https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"é«˜è¯„åˆ†æˆ¿é—´ï¼ŒæœåŠ¡ä¼˜è´¨"},{id:5,code:"102",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å¤§åºŠæˆ¿",floor:"1æ¥¼",height:"2438",hasWindow:!0,windowDirection:"ä¸œ",roomType:"å¤§åºŠæˆ¿",price:888,seat:2,rating:4.8,status:"available",image:"https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"è±ªåå¤§åºŠæˆ¿ï¼Œå¸¦çª—æˆ·ï¼Œè§†é‡å¼€é˜”"},{id:6,code:"106",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:666,seat:1,rating:4.7,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"å—å‘æˆ¿é—´ï¼Œé‡‡å…‰å……è¶³ï¼Œç¯å¢ƒä¼˜é›…"},{id:7,code:"107",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:456,seat:1,rating:4.6,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"ä¸­ç­‰ä»·ä½ï¼Œæ€§ä»·æ¯”ä¸é”™"},{id:8,code:"108",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:156,seat:1,rating:4.4,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"ç»æµå®æƒ ï¼Œé€‚åˆé¢„ç®—æœ‰é™çš„å®¢äºº"},{id:9,code:"101",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"1æ¥¼",height:"2438",hasWindow:!0,windowDirection:"ä¸œ",roomType:"å•äººé—´",price:18,seat:1,rating:4.2,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"è¶…å€¼ç‰¹ä»·æˆ¿ï¼Œæ€§ä»·æ¯”æé«˜"},{id:10,code:"211",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"äº²å­æˆ¿",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"è¥¿",roomType:"äº²å­æˆ¿",price:419,seat:3,rating:4.7,status:"available",image:"https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00",recommendReason:"äº²å­æˆ¿ï¼Œé€‚åˆå®¶åº­å‡ºè¡Œï¼Œç©ºé—´å®½æ•"},{id:11,code:"212",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"äº²å­æˆ¿",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"è¥¿",roomType:"äº²å­æˆ¿",price:418,seat:3,rating:4.7,status:"available",image:"https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:12,code:"210",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"åŒ—",roomType:"å•äººé—´",price:189,seat:1,rating:4.4,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:13,code:"209",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"åŒ—",roomType:"å•äººé—´",price:418,seat:1,rating:4.6,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:14,code:"208",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"åŒ—",roomType:"å•äººé—´",price:18,seat:1,rating:4.2,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:15,code:"207",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å¤§åºŠæˆ¿",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"ä¸œ",roomType:"å¤§åºŠæˆ¿",price:186,seat:2,rating:4.5,status:"available",image:"https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:16,code:"206",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"åŒäººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"è¥¿",roomType:"åŒäººé—´",price:654,seat:2,rating:4.7,status:"available",image:"https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:17,code:"205",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"åŒäººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"ä¸œ",roomType:"åŒäººé—´",price:789,seat:2,rating:4.8,status:"available",image:"https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:18,code:"204",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:999,seat:1,rating:4.9,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:19,code:"203",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:889,seat:1,rating:4.8,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:20,code:"202",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å•äººé—´",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å•äººé—´",price:48,seat:1,rating:4.3,status:"available",image:"https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:21,code:"201",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"å¤§åºŠæˆ¿",floor:"2æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"å¤§åºŠæˆ¿",price:19,seat:2,rating:4.1,status:"available",image:"https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:22,code:"301",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"äº²å­æˆ¿",floor:"3æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"äº²å­æˆ¿",price:486,seat:4,rating:4.8,status:"available",image:"https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:23,code:"302",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"äº²å­æˆ¿",floor:"3æ¥¼",height:"2438",hasWindow:!1,windowDirection:"æ— ",roomType:"äº²å­æˆ¿",price:1088,seat:4,rating:4.9,status:"available",image:"https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"},{id:24,code:"303",name:"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",category:"åŒäººé—´",floor:"3æ¥¼",height:"2438",hasWindow:!0,windowDirection:"å—",roomType:"åŒäººé—´",price:0,seat:2,rating:4.6,status:"unavailable",image:"https://images.unsplash.com/photo-1618773928121-c32242e63f39?w=400&h=300&fit=crop",vrUrl:"https://share-xt.hwbim.com/qlh/ffd333620ebb4e83b50899653b516f00"}];N.value=a,O.value=a}catch(a){console.error("åŠ è½½æˆ¿é—´æ•°æ®å¤±è´¥:",a)}finally{V.value=!1}},$=()=>{P.value==="all"?O.value=N.value.filter(a=>a.code!=="å±•è§ˆå…"):O.value=N.value.filter(a=>{if(a.code==="å±•è§ˆå…")return!1;switch(P.value){case"single":return a.roomType==="å•äººé—´";case"double":return a.roomType==="åŒäººé—´"||a.roomType==="å¤§åºŠæˆ¿";case"family":return a.roomType==="äº²å­æˆ¿";case"suite":return a.category.includes("å¥—æˆ¿")||a.category.includes("è±ªå");default:return!0}})},C=()=>{S.value=!0,console.log("Dify AIåŠ©æ‰‹åŠ è½½æˆåŠŸ")},E=a=>{S.value=!1,console.error("Dify AIåŠ©æ‰‹åŠ è½½å¤±è´¥:",a)},W=a=>{console.log("é€‰æ‹©æˆ¿é—´:",a)};p("æˆ‘ä¼šæ ¹æ®æ‚¨çš„éœ€æ±‚ä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„æˆ¿é—´");const B=a=>{if(U.value=a,x.value){const t=x.value.children[a];t&&t.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},G=()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const a=window.webkitSpeechRecognition||window.SpeechRecognition;y.value=new a,y.value.continuous=!1,y.value.interimResults=!1,y.value.lang="zh-CN",y.value.onresult=s=>{const t=s.results[0][0].transcript;h.value=t,f.value=!1},y.value.onerror=s=>{console.error("è¯­éŸ³è¯†åˆ«é”™è¯¯:",s.error),f.value=!1},y.value.onend=()=>{f.value=!1}}},oe=()=>{y.value||G(),f.value?(y.value.stop(),f.value=!1):(h.value="",y.value.start(),f.value=!0)},ie=()=>{h.value&&M.value&&(M.value.sendMessage(h.value),h.value="")},ne=()=>{h.value=""},le=()=>{M.value&&M.value.resetConversation(),g.value=[],c.value=null},re=a=>{const s=[];if(console.log("è§£ææˆ¿é—´æ¨èï¼Œæ¶ˆæ¯å†…å®¹:",a),[/ã€(\d{3})[^ã€‘]*ã€‘/g,/(\d{3})å·?æˆ¿/g,/æˆ¿é—´å·[ï¼š:]\s*(\d{3})/g,/æˆ¿é—´\s*(\d{3})/g,/(\d{3})\s*æˆ¿é—´/g,/æ¨è.*?(\d{3})/g,/å»ºè®®.*?(\d{3})/g,/é€‚åˆ.*?(\d{3})/g,/(\d{3}).*?å…ƒ/g].forEach(v=>{const o=a.match(v);o&&o.forEach(_=>{const D=_.match(/\d{3}/)?.[0];if(D){const L=k.find(b=>b.code===D);L&&!s.find(b=>b.code===D)&&(console.log("æ‰¾åˆ°æ¨èæˆ¿é—´:",D,L.name),s.push({...L,recommendReason:ce(a,D)}))}})}),s.length===0){const v=de(a);s.push(...v)}return console.log("è§£æç»“æœ:",s),s},ce=(a,s)=>{const t=[new RegExp(`${s}.*?å› ä¸º(.{10,50})`,"i"),new RegExp(`æ¨è${s}.*?(.{10,50})`,"i"),new RegExp(`${s}.*?é€‚åˆ(.{10,50})`,"i")];for(const v of t){const o=a.match(v);if(o&&o[1])return o[1].trim()}return"æ ¹æ®æ‚¨çš„éœ€æ±‚æ¨è"},de=a=>{const s=[],t=a.toLowerCase();return(t.includes("æ¨è")||t.includes("æˆ¿é—´")||t.includes("é€‰æ‹©"))&&[k.find(o=>o.code==="208"),k.find(o=>o.code==="202"),k.find(o=>o.code==="204"),k.find(o=>o.code==="108")].filter(Boolean).forEach((o,_)=>{if(o){let D="";switch(_){case 0:D="æ€§ä»·æ¯”é«˜ï¼ŒèŒ¶å›­æ™¯è§‚";break;case 1:D="ä¸­æ¡£èˆ’é€‚ï¼Œå—å‘é‡‡å…‰";break;case 2:D="è±ªåå±±æ™¯ï¼Œè®¾æ–½å®Œå–„";break;case 3:D="ç»æµå®æƒ ï¼Œ1æ¥¼ä¾¿åˆ©";break;default:D="æ ¹æ®æ‚¨çš„éœ€æ±‚æ¨è"}s.push({...o,recommendReason:D})}}),(t.includes("ä¾¿å®œ")||t.includes("ç»æµ")||t.includes("å®æƒ "))&&k.filter(o=>o.price<=200).slice(0,2).forEach(o=>{s.find(_=>_.code===o.code)||s.push({...o,recommendReason:"ä»·æ ¼å®æƒ ï¼Œæ€§ä»·æ¯”é«˜"})}),(t.includes("è±ªå")||t.includes("é«˜æ¡£")||t.includes("å¥¢å"))&&k.filter(o=>o.price>=400).slice(0,2).forEach(o=>{s.find(_=>_.code===o.code)||s.push({...o,recommendReason:"è±ªåèˆ’é€‚ï¼Œè®¾æ–½å®Œå–„"})}),(t.includes("å®¶åº­")||t.includes("äº²å­")||t.includes("å­©å­"))&&k.filter(o=>o.type.includes("åŒäºº")||o.type.includes("äº²å­")).slice(0,2).forEach(o=>{s.find(_=>_.code===o.code)||s.push({...o,recommendReason:"é€‚åˆå®¶åº­å…¥ä½ï¼Œç©ºé—´å®½æ•"})}),s},ue=a=>{const s={};console.log("è§£æè®¢å•ä¿¡æ¯ï¼Œæ¶ˆæ¯å†…å®¹:",a);const t=[/(\d{3})å·?æˆ¿/,/æˆ¿é—´å·[ï¼š:]\s*(\d{3})/,/æˆ¿é—´\s*(\d{3})/,/(\d{3})\s*æˆ¿é—´/,/é¢„è®¢.*?(\d{3})/,/é€‰æ‹©.*?(\d{3})/];for(const b of t){const u=a.match(b);if(u){s.roomCode=u[1];const A=k.find(be=>be.code===u[1]);A&&(s.roomName=A.name,s.price=A.price);break}}const v=[/(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥/,/(\d{4})-(\d{1,2})-(\d{1,2})/,/(\d{1,2})æœˆ(\d{1,2})æ—¥/,/å…¥ä½.*?(\d{4})å¹´(\d{1,2})æœˆ(\d{1,2})æ—¥/,/å…¥ä½.*?(\d{4})-(\d{1,2})-(\d{1,2})/,/å…¥ä½æ—¶é—´.*?(\d{1,2})æœˆ(\d{1,2})æ—¥/,/(\d{1,2})\/(\d{1,2})\/(\d{4})/,/7æœˆ(\d{1,2})æ—¥/,/(\d{1,2})æœˆ(\d{1,2})å·/];for(const b of v){const u=a.match(b);if(u){if(u.length===4)s.checkInDate=`${u[1]}-${u[2].padStart(2,"0")}-${u[3].padStart(2,"0")}`;else if(u.length===3){const A=new Date().getFullYear();s.checkInDate=`${A}-${u[1].padStart(2,"0")}-${u[2].padStart(2,"0")}`}else if(b.source.includes("7æœˆ")){const A=new Date().getFullYear();s.checkInDate=`${A}-07-${u[1].padStart(2,"0")}`}break}}const o=[/é€€æˆ¿.*?(\d{1,2})æœˆ(\d{1,2})æ—¥/,/é€€æˆ¿æ—¶é—´.*?(\d{1,2})æœˆ(\d{1,2})æ—¥/,/7æœˆ(\d{1,2})æ—¥.*?é€€æˆ¿/,/é€€æˆ¿.*?7æœˆ(\d{1,2})æ—¥/];for(const b of o){const u=a.match(b);if(u){const A=new Date().getFullYear();b.source.includes("7æœˆ")?s.checkOutDate=`${A}-07-${u[1].padStart(2,"0")}`:s.checkOutDate=`${A}-${u[1].padStart(2,"0")}-${u[2].padStart(2,"0")}`;break}}const _=[/1[3-9]\d{9}/,/æ‰‹æœº[ï¼š:]\s*(1[3-9]\d{9})/,/ç”µè¯[ï¼š:]\s*(1[3-9]\d{9})/,/è”ç³»æ–¹å¼[ï¼š:]\s*(1[3-9]\d{9})/];for(const b of _){const u=a.match(b);if(u){s.phone=u[1]||u[0];break}}const D=[/(\d+)å…ƒ/,/æ€»è®¡[ï¼š:]\s*(\d+)/,/è´¹ç”¨[ï¼š:]\s*(\d+)/,/ä»·æ ¼[ï¼š:]\s*(\d+)/,/Â¥(\d+)/];for(const b of D){const u=a.match(b);if(u){s.totalAmount=parseInt(u[1]);break}}const L=[/å§“å[ï¼š:]\s*([^\s\d]{2,4})/,/å®¢äºº[ï¼š:]\s*([^\s\d]{2,4})/,/é¢„è®¢äºº[ï¼š:]\s*([^\s\d]{2,4})/];for(const b of L){const u=a.match(b);if(u){s.guestName=u[1];break}}return console.log("è§£æè®¢å•ç»“æœ:",s),s},pe=a=>{if(console.log("æ”¶åˆ°Difyæ¶ˆæ¯:",a),a.type==="ai"&&a.content){const s=re(a.content);if(s.length>0&&(g.value=s,console.log("æ›´æ–°AIæ¨èæˆ¿é—´:",s)),["é¢„è®¢æˆåŠŸ","è®¢å•è¯¦æƒ…","é¢„è®¢ç¡®è®¤","è®¢å•ç¡®è®¤","é¢„è®¢å®Œæˆ","å·²é¢„è®¢","é¢„è®¢ä¿¡æ¯","è®¢å•ç”Ÿæˆ","ç¡®è®¤é¢„è®¢","é¢„è®¢å•","è®¢å•åˆ›å»º","é¢„è®¢è®°å½•"].some(o=>a.content.includes(o))){const o=ue(a.content);if(o.roomCode){const _={orderNumber:"ORD"+Date.now(),roomCode:o.roomCode,roomName:o.roomName||"é›¨æ—æ™¯è§‚è±ªåè˜‘è‡å±‹",checkInDate:o.checkInDate||Q(),checkOutDate:fe(o.checkInDate||Q()),totalAmount:o.totalAmount||o.price||48,phone:o.phone||"å¾…è¡¥å……",guestName:o.guestName||"å¾…è¡¥å……",status:"confirmed",createdAt:new Date().toISOString()};c.value=_,console.log("åˆ›å»ºè®¢å•:",_),me(_)}}}},Q=()=>{const a=new Date;return a.setDate(a.getDate()+1),a.toISOString().split("T")[0]},fe=a=>{const s=new Date(a);return s.setDate(s.getDate()+1),s.toISOString().split("T")[0]},me=a=>{console.log("è®¢å•åˆ›å»ºæˆåŠŸé€šçŸ¥:",a)},he=a=>k.find(t=>t.code===a)?.image||"/src/assets/images/å®åœ°è°ƒç ”/æˆ¿é—´è°ƒç ”/æˆ¿é—´è°ƒç ”1.jpg",X=a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),ve=()=>{c.value&&(c.value=null,console.log("è®¢å•å·²å–æ¶ˆ"))},ge=()=>{c.value&&console.log("è®¢å•ä¿®æ”¹è¯·æ±‚")};return(a,s)=>(r(),l("div",Ye,[Z(Ie),s[45]||(s[45]=H('<div class="page-header" data-v-f7505592><div class="container" data-v-f7505592><h1 class="page-title" data-v-f7505592><span class="ai-icon" data-v-f7505592>ğŸŒ³</span> AIæ™ºèƒ½é€‰æˆ¿ </h1><p class="page-subtitle" data-v-f7505592>ä¸æ™®æ™®AIåŠ©æ‰‹å¯¹è¯ï¼Œæ‰¾åˆ°æœ€é€‚åˆæ‚¨çš„æˆ¿é—´</p></div></div>',1)),e("div",He,[e("div",Je,[e("div",Ge,[e("div",Qe,[e("div",Xe,[e("div",Ze,[e("div",es,[e("video",{ref_key:"aiVideo",ref:j,src:q.value,alt:"æ™®æ™®AIåŠ©æ‰‹",class:T(["ai-character",Y.value]),autoplay:"",loop:"",muted:"",playsinline:""},null,10,ss),F.value?(r(),l("div",ts,s[3]||(s[3]=[e("div",{class:"wave"},null,-1),e("div",{class:"wave"},null,-1),e("div",{class:"wave"},null,-1)]))):R("",!0)]),e("div",as,[s[4]||(s[4]=e("h3",null,"æ™®æ™® AIåŠ©æ‰‹",-1)),s[5]||(s[5]=e("p",null,"ä¸“å±é€‰æˆ¿é¡¾é—®",-1)),e("div",os,[e("span",{class:T(["status-dot",{online:S.value}])},null,2),e("span",null,n(S.value?"åœ¨çº¿":"ç¦»çº¿"),1)])])]),e("div",is,[e("div",ns,[e("button",{class:T(["control-btn voice-btn",{active:f.value}]),onClick:oe,disabled:!S.value},[f.value?(r(),l("i",cs)):(r(),l("i",rs)),e("span",null,n(f.value?"åœæ­¢å½•éŸ³":"è¯­éŸ³è¾“å…¥"),1)],10,ls),e("button",{class:"control-btn reset-btn",onClick:le,disabled:!S.value},s[6]||(s[6]=[e("i",{class:"fas fa-redo-alt"},null,-1),e("span",null,"é‡ç½®å¯¹è¯",-1)]),8,ds)]),f.value?(r(),l("div",us,s[7]||(s[7]=[H('<div class="voice-wave" data-v-f7505592><div class="wave-bar" data-v-f7505592></div><div class="wave-bar" data-v-f7505592></div><div class="wave-bar" data-v-f7505592></div><div class="wave-bar" data-v-f7505592></div><div class="wave-bar" data-v-f7505592></div></div><p class="voice-text" data-v-f7505592>æ­£åœ¨è†å¬æ‚¨çš„è¯­éŸ³...</p>',2)]))):R("",!0),h.value?(r(),l("div",ps,[s[10]||(s[10]=e("p",{class:"voice-label"},"è¯†åˆ«ç»“æœï¼š",-1)),e("p",fs,n(h.value),1),e("div",{class:"voice-actions"},[e("button",{class:"send-voice-btn",onClick:ie},s[8]||(s[8]=[e("i",{class:"fas fa-paper-plane"},null,-1),I(" å‘é€ ")])),e("button",{class:"clear-voice-btn",onClick:ne},s[9]||(s[9]=[e("i",{class:"fas fa-times"},null,-1),I(" æ¸…é™¤ ")]))])])):R("",!0)])]),e("div",ms,[e("h3",null,[s[11]||(s[11]=e("i",{class:"fas fa-star"},null,-1)),s[12]||(s[12]=I(" AIæ¨èæˆ¿é—´ ")),g.value.length>0?(r(),l("span",hs,"("+n(g.value.length)+")",1)):R("",!0)]),e("div",vs,[g.value.length===0?(r(),l("div",gs,s[13]||(s[13]=[e("i",{class:"fas fa-robot"},null,-1),e("p",null,"è¯·ä¸AIåŠ©æ‰‹å¯¹è¯ï¼Œæˆ‘ä¼šä¸ºæ‚¨æ¨èæœ€é€‚åˆçš„æˆ¿é—´",-1),e("p",{class:"empty-hint"},"ä¾‹å¦‚ï¼šæˆ‘æƒ³è¦ä¸€ä¸ªä¾¿å®œçš„æˆ¿é—´ã€æ¨èè±ªåæˆ¿é—´ã€é€‚åˆå®¶åº­çš„æˆ¿é—´",-1)]))):(r(),l("div",bs,[e("div",{class:"rooms-scroll",ref_key:"roomsScrollContainer",ref:x},[(r(!0),l(z,null,K(g.value,t=>(r(),l("div",{key:t.id,class:"room-card recommended",onClick:v=>W(t)},[s[15]||(s[15]=e("div",{class:"recommend-badge"},[e("i",{class:"fas fa-robot"}),I(" AIæ¨è ")],-1)),e("img",{src:t.image,alt:t.name,class:"room-image"},null,8,ys),e("div",_s,[e("h4",null,n(t.code)+"å·æˆ¿",1),e("p",null,n(t.name),1),t.recommendReason?(r(),l("div",ks,[s[14]||(s[14]=e("i",{class:"fas fa-lightbulb"},null,-1)),I(" "+n(t.recommendReason),1)])):R("",!0),e("div",Ds,[e("span",Is,"Â¥"+n(t.price)+"/æ™š",1),e("span",Ts,"â­"+n(t.rating),1),e("span",{class:T(["status",t.status])},n(t.status==="available"?"å¯é¢„è®¢":"å·²é¢„è®¢"),3)])])],8,ws))),128))],512),g.value.length>1?(r(),l("div",Rs,[(r(!0),l(z,null,K(g.value,(t,v)=>(r(),l("div",{key:v,class:T(["indicator",{active:U.value===v}]),onClick:o=>B(v)},null,10,$s))),128))])):R("",!0)]))])]),e("div",Cs,[e("h3",null,[s[16]||(s[16]=e("i",{class:"fas fa-receipt"},null,-1)),s[17]||(s[17]=I(" è®¢å•è¯¦æƒ… ")),c.value?(r(),l("span",Ss,"å·²ç¡®è®¤")):R("",!0)]),e("div",xs,[c.value?(r(),l("div",As,[e("div",Us,[e("div",Os,[s[18]||(s[18]=e("span",{class:"label"},"è®¢å•å·",-1)),e("span",Ws,n(c.value.orderNumber),1)]),e("div",Ms,[s[19]||(s[19]=e("span",{class:"label"},"åˆ›å»ºæ—¶é—´",-1)),e("span",Ns,n(new Date(c.value.createdAt).toLocaleString()),1)])]),e("div",qs,[e("div",Ps,[e("img",{src:he(c.value.roomCode),alt:"æˆ¿é—´å›¾ç‰‡",class:"room-thumbnail"},null,8,Es)]),e("div",js,[e("h4",null,n(c.value.roomCode)+"å·æˆ¿ - "+n(c.value.roomName),1),e("div",Vs,[e("div",Bs,[s[20]||(s[20]=e("i",{class:"fas fa-calendar-check"},null,-1)),e("span",null,"å…¥ä½: "+n(X(c.value.checkInDate)),1)]),e("div",Ls,[s[21]||(s[21]=e("i",{class:"fas fa-calendar-times"},null,-1)),e("span",null,"é€€æˆ¿: "+n(X(c.value.checkOutDate)),1)])])])]),e("div",zs,[e("div",Ks,[s[22]||(s[22]=e("i",{class:"fas fa-user"},null,-1)),s[23]||(s[23]=e("span",{class:"label"},"å®¢äºº:",-1)),e("span",Fs,n(c.value.guestName||"å¾…è¡¥å……"),1)]),e("div",Ys,[s[24]||(s[24]=e("i",{class:"fas fa-phone"},null,-1)),s[25]||(s[25]=e("span",{class:"label"},"ç”µè¯:",-1)),e("span",Hs,n(c.value.phone||"å¾…è¡¥å……"),1)])]),e("div",Js,[e("div",Gs,[s[26]||(s[26]=e("span",{class:"label"},"æˆ¿è´¹",-1)),e("span",Qs,"Â¥"+n(c.value.totalAmount),1)]),s[28]||(s[28]=e("div",{class:"summary-item"},[e("span",{class:"label"},"æœåŠ¡è´¹"),e("span",{class:"value"},"Â¥0")],-1)),e("div",Xs,[s[27]||(s[27]=e("span",{class:"label"},"æ€»è®¡",-1)),e("span",Zs,"Â¥"+n(c.value.totalAmount),1)])]),e("div",{class:"order-actions"},[e("button",{class:"btn btn-outline",onClick:ve},s[29]||(s[29]=[e("i",{class:"fas fa-times"},null,-1),I(" å–æ¶ˆè®¢å• ")])),e("button",{class:"btn btn-primary",onClick:ge},s[30]||(s[30]=[e("i",{class:"fas fa-edit"},null,-1),I(" ä¿®æ”¹è®¢å• ")]))])])):(r(),l("div",et,s[31]||(s[31]=[e("i",{class:"fas fa-clipboard-list"},null,-1),e("p",null,"æš‚æ— è®¢å•ä¿¡æ¯",-1),e("p",{class:"empty-hint"},"ä¸AIåŠ©æ‰‹å¯¹è¯ï¼Œåˆ›å»ºè®¢å•åå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ",-1),e("p",{class:"empty-hint"},"ä¾‹å¦‚ï¼šæˆ‘æƒ³é¢„è®¢101å·æˆ¿é—´",-1)])))])])]),e("div",st,[e("div",tt,[e("div",at,[s[32]||(s[32]=e("h3",null,[e("i",{class:"fas fa-comments"}),I(" ä¸AIåŠ©æ‰‹å¯¹è¯ ")],-1)),e("div",ot,[e("span",{class:T(["status-dot",{online:S.value}])},null,2),e("span",null,n(S.value?"åœ¨çº¿":"ç¦»çº¿"),1)])]),e("div",it,[Z(Fe,{ref_key:"difyChatWidget",ref:M,"container-id":"ai-room-dify-container","auto-load":!0,onLoaded:C,onError:E,onMessage:pe},null,512)])])])]),e("div",nt,[e("div",lt,[s[36]||(s[36]=e("h2",null,[e("i",{class:"fas fa-home"}),I(" å…¨éƒ¨æˆ¿é—´ ")],-1)),e("div",rt,[te(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>P.value=t),onChange:$,class:"filter-select"},s[33]||(s[33]=[H('<option value="all" data-v-f7505592>å…¨éƒ¨æˆ¿å‹</option><option value="single" data-v-f7505592>å•äººæˆ¿</option><option value="double" data-v-f7505592>åŒäººæˆ¿</option><option value="family" data-v-f7505592>å®¶åº­æˆ¿</option><option value="suite" data-v-f7505592>å¥—æˆ¿</option>',5)]),544),[[Te,P.value]]),e("div",ct,[e("button",{class:T(["toggle-btn",{active:d.value==="grid"}]),onClick:s[1]||(s[1]=t=>d.value="grid")},s[34]||(s[34]=[e("i",{class:"fas fa-th"},null,-1)]),2),e("button",{class:T(["toggle-btn",{active:d.value==="list"}]),onClick:s[2]||(s[2]=t=>d.value="list")},s[35]||(s[35]=[e("i",{class:"fas fa-list"},null,-1)]),2)])])]),e("div",dt,[V.value?(r(),l("div",ut,s[37]||(s[37]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"æ­£åœ¨åŠ è½½æˆ¿é—´ä¿¡æ¯...",-1)]))):O.value.length===0?(r(),l("div",pt,s[38]||(s[38]=[e("i",{class:"fas fa-home"},null,-1),e("p",null,"æš‚æ— ç¬¦åˆæ¡ä»¶çš„æˆ¿é—´",-1)]))):(r(),l("div",{key:2,class:T(["rooms-grid",d.value])},[(r(!0),l(z,null,K(O.value,t=>(r(),l("div",{key:t.id,class:"room-item",onClick:v=>W(t)},[e("div",mt,[e("img",{src:t.image,alt:t.name,class:"room-image"},null,8,ht),e("div",{class:T(["room-status-badge",t.status])},n(t.status==="available"?"å¯é¢„è®¢":"å·²é¢„è®¢"),3),e("div",vt,n(t.price>0?`Â¥${t.price}/æ™š`:"ä»·æ ¼å¾…å®š"),1)]),e("div",gt,[e("div",bt,[e("h4",wt,n(t.code)+"å·æˆ¿ - "+n(t.roomType),1),t.rating>0?(r(),l("div",yt,[s[39]||(s[39]=e("i",{class:"fas fa-star"},null,-1)),e("span",null,n(t.rating),1)])):R("",!0)]),e("p",_t,n(t.name)+" ("+n(t.floor)+")",1),e("div",kt,[t.seat>0?(r(),l("span",Dt,[s[40]||(s[40]=e("i",{class:"fas fa-users"},null,-1)),I(" "+n(t.seat)+"äºº ",1)])):R("",!0),e("span",It,[s[41]||(s[41]=e("i",{class:"fas fa-window-maximize"},null,-1)),I(" "+n(t.hasWindow?`${t.windowDirection}å‘`:"æ— çª—"),1)]),s[43]||(s[43]=e("span",{class:"feature"},[e("i",{class:"fas fa-wifi"}),I(" å…è´¹WiFi ")],-1)),s[44]||(s[44]=e("span",{class:"feature"},[e("i",{class:"fas fa-snowflake"}),I(" ç©ºè°ƒ ")],-1)),t.vrUrl?(r(),l("span",Tt,[s[42]||(s[42]=e("i",{class:"fas fa-vr-cardboard"},null,-1)),e("a",{href:t.vrUrl,target:"_blank",class:"vr-link"},"VRçœ‹æˆ¿",8,Rt)])):R("",!0)]),e("div",$t,[e("div",Ct,n(t.category),1),e("button",{class:T(["book-btn",{disabled:t.status!=="available"||t.price===0}]),disabled:t.status!=="available"||t.price===0,onClick:Re(v=>W(t),["stop"])},n(t.price===0?"ä»·æ ¼å¾…å®š":t.status==="available"?"é€‰æ‹©æˆ¿é—´":"å·²é¢„è®¢"),11,St)])])],8,ft))),128))],2))])])])])]))}}),Wt=ae(xt,[["__scopeId","data-v-f7505592"]]);export{Wt as default};
