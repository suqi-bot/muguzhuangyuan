import{d as q,u as T,a as j,r as N,b as i,c as x,o as O,e as W,f as u,g as p,h as P,i as e,A as G,j as _,F as H,k as J,l as w,w as K,m as c,v as C,n as Q,p as X,q as Y,s as V,t as k,x as Z,y as aa,z as S,B as ea,C as M,D as sa,E as oa,_ as ta}from"./index-vYzfv9NW.js";import{r as na}from"./request-DzKJqaQU.js";import{A as la}from"./aos-CzWz6qMZ.js";const ia={class:"login-page"},ra={class:"animated-background"},da={class:"floating-particles"},ua={class:"login-main"},pa={class:"login-container"},va={class:"login-card","data-aos":"fade-up","data-aos-duration":"800"},fa={class:"form-group","data-aos":"fade-right","data-aos-delay":"400"},ca={class:"input-wrapper"},ma={class:"form-group","data-aos":"fade-right","data-aos-delay":"500"},ba={class:"input-wrapper"},ga=["type"],ya={class:"form-options","data-aos":"fade-up","data-aos-delay":"600"},ha={class:"checkbox-wrapper"},wa=["disabled"],ka={key:0,class:"loading-spinner"},xa={key:0,class:"phone-form"},_a={class:"form-group"},Ca={class:"input-wrapper"},Va={key:0,class:"error-message"},Da={class:"form-group"},La={class:"input-wrapper verify-wrapper"},Na=["disabled"],Pa=["disabled"],Sa={key:0,class:"loading-spinner"},Ma={class:"register-link"},$a=q({__name:"LoginView",setup(Ua){const D=T(),m=j(),l=N({username:"",password:"",remember:!1}),t=N({phone:"",verifyCode:""}),b=i(!1),v=i(!1),g=i(!1),f=i(!1),y=i(!1),r=i(0),d=i(""),$=()=>{b.value=!b.value},U=async()=>{v.value=!0;try{const s=await na.post("/h/user/login",{username:l.username,password:l.password});if(console.log("登录响应:",s),s.code!=="200")throw new Error(s.msg||"登录失败");const a=s.data||s,o=a.user||a,n=a.tokenInfo||{tokenValue:a.token};m.login(l.username,n.tokenValue||"temp-token",o.realName||o.name||o.username,o.phonenumber||o.phone,o.gender,o.idCard,o.avatar,o.total,o.username,o.realName),m.setUserRole("user"),M(o.username||"用户"),D.push("/ai-rooms")}catch(s){console.error("登录失败:",s),oa("用户名或密码错误")}finally{v.value=!1}},h=x(()=>/^1[3-9]\d{9}$/.test(t.phone)),L=x(()=>h.value&&t.verifyCode.length===6),E=x(()=>r.value>0?`${r.value}s后重发`:y.value?"发送中...":"获取验证码"),I=()=>{g.value=!g.value,g.value&&(t.phone="",t.verifyCode="",d.value="")},z=()=>{d.value="",t.phone&&!h.value&&(d.value="请输入正确的手机号格式")},A=async()=>{if(!h.value){d.value="请输入正确的手机号";return}y.value=!0;try{console.log("发送验证码到:",t.phone),aa("验证码已发送",`验证码已发送到 ${t.phone}，请注意查收`),r.value=60;const s=setInterval(()=>{r.value--,r.value<=0&&clearInterval(s)},1e3)}catch(s){console.error("发送验证码失败:",s),S("发送失败","发送验证码失败，请稍后重试")}finally{y.value=!1}},B=async()=>{if(!L.value){ea("信息不完整","请填写完整的手机号和验证码");return}f.value=!0;try{console.log("手机号验证登录:",t.phone,t.verifyCode);const s={username:t.phone,realName:"手机用户",phone:t.phone,token:"phone-login-token-"+Date.now()};m.login(s.username,s.token,s.realName,s.phone,void 0,void 0,void 0,void 0,s.username,s.realName),m.setUserRole("user"),M(s.phone||"用户"),D.push("/ai-rooms")}catch(s){console.error("手机号验证登录失败:",s),S("验证失败","验证码错误或已过期，请重试")}finally{f.value=!1}},F=s=>{const a=Math.random()*4+2,o=Math.random()*100,n=Math.random()*20,R=Math.random()*10+10;return{width:`${a}px`,height:`${a}px`,left:`${o}%`,animationDelay:`${n}s`,animationDuration:`${R}s`}};return O(()=>{la.init({duration:800,easing:"ease-out-cubic",once:!0,offset:50})}),(s,a)=>{const o=W("router-link");return p(),u("div",ia,[P(G),e("div",ra,[e("div",da,[(p(),u(H,null,J(15,n=>e("div",{class:"particle",key:n,style:sa(F())},null,4)),64))]),a[5]||(a[5]=_('<div class="gradient-orbs" data-v-ea1b047e><div class="orb orb-1" data-v-ea1b047e></div><div class="orb orb-2" data-v-ea1b047e></div><div class="orb orb-3" data-v-ea1b047e></div></div><div class="floating-elements" data-v-ea1b047e><div class="floating-element mushroom-1" data-v-ea1b047e>🍄</div><div class="floating-element mushroom-2" data-v-ea1b047e>🌿</div><div class="floating-element mushroom-3" data-v-ea1b047e>🍃</div></div>',2))]),e("main",ua,[e("div",pa,[e("div",va,[a[20]||(a[20]=_('<div class="login-header" data-aos="fade-down" data-aos-delay="200" data-v-ea1b047e><div class="login-icon" data-v-ea1b047e><span class="mushroom-icon" data-v-ea1b047e>🍄</span></div><h1 class="login-title" data-v-ea1b047e>普洱蘑菇庄园民宿</h1><p class="login-subtitle" data-v-ea1b047e>登录您的账户，体验自然生态之美</p></div>',1)),e("form",{class:"login-form",onSubmit:K(U,["prevent"]),"data-aos":"fade-up","data-aos-delay":"300"},[e("div",fa,[a[7]||(a[7]=e("label",{for:"email",class:"form-label"},"用户名",-1)),e("div",ca,[a[6]||(a[6]=e("i",{class:"fas fa-user input-icon"},null,-1)),c(e("input",{type:"text",id:"username","onUpdate:modelValue":a[0]||(a[0]=n=>l.username=n),class:"form-input",placeholder:"请输入您的用户名",required:""},null,512),[[C,l.username]])])]),e("div",ma,[a[9]||(a[9]=e("label",{for:"password",class:"form-label"},"密码",-1)),e("div",ba,[a[8]||(a[8]=e("i",{class:"fas fa-lock input-icon"},null,-1)),c(e("input",{type:b.value?"text":"password",id:"password","onUpdate:modelValue":a[1]||(a[1]=n=>l.password=n),class:"form-input",placeholder:"请输入您的密码",required:""},null,8,ga),[[Q,l.password]]),e("button",{type:"button",class:"password-toggle",onClick:$},[e("i",{class:X(b.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",ya,[e("label",ha,[c(e("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=n=>l.remember=n)},null,512),[[Y,l.remember]]),a[10]||(a[10]=e("span",{class:"checkmark"},null,-1)),a[11]||(a[11]=e("span",{class:"checkbox-text"},"记住我",-1))]),a[12]||(a[12]=e("a",{href:"#",class:"forgot-link"},"忘记密码？",-1))]),e("button",{type:"submit",class:"login-btn",disabled:v.value,"data-aos":"zoom-in","data-aos-delay":"700"},[v.value?(p(),u("span",ka)):w("",!0),V(" "+k(v.value?"登录中...":"登录"),1)],8,wa)],32),a[21]||(a[21]=e("div",{class:"divider","data-aos":"fade-up","data-aos-delay":"800"},[e("span",{class:"divider-text"},"或")],-1)),e("div",{class:"phone-login","data-aos":"fade-up","data-aos-delay":"900"},[e("button",{type:"button",class:"phone-login-btn",onClick:I},a[13]||(a[13]=[e("i",{class:"fas fa-mobile-alt"},null,-1),e("span",null,"手机号验证登录",-1)]))]),g.value?(p(),u("div",xa,[e("div",_a,[a[15]||(a[15]=e("label",{for:"phone",class:"form-label"},"手机号",-1)),e("div",Ca,[a[14]||(a[14]=e("i",{class:"fas fa-mobile-alt input-icon"},null,-1)),c(e("input",{type:"tel",id:"phone","onUpdate:modelValue":a[3]||(a[3]=n=>t.phone=n),class:"form-input",placeholder:"请输入手机号",maxlength:"11",onInput:z},null,544),[[C,t.phone]])]),d.value?(p(),u("div",Va,k(d.value),1)):w("",!0)]),e("div",Da,[a[17]||(a[17]=e("label",{for:"verifyCode",class:"form-label"},"验证码",-1)),e("div",La,[a[16]||(a[16]=e("i",{class:"fas fa-shield-alt input-icon"},null,-1)),c(e("input",{type:"text",id:"verifyCode","onUpdate:modelValue":a[4]||(a[4]=n=>t.verifyCode=n),class:"form-input verify-input",placeholder:"请输入验证码",maxlength:"6"},null,512),[[C,t.verifyCode]]),e("button",{type:"button",class:"verify-btn",disabled:!h.value||y.value||r.value>0,onClick:A},k(E.value),9,Na)])]),e("button",{type:"button",class:"phone-submit-btn",disabled:!L.value||f.value,onClick:B},[f.value?(p(),u("span",Sa)):w("",!0),V(" "+k(f.value?"验证中...":"验证登录"),1)],8,Pa)])):w("",!0),e("div",Ma,[a[19]||(a[19]=e("span",null,"还没有账户？",-1)),P(o,{to:"/register",class:"register-btn"},{default:Z(()=>a[18]||(a[18]=[V("立即注册")])),_:1,__:[18]})])]),a[22]||(a[22]=_('<div class="login-info" data-aos="fade-left" data-aos-delay="400" data-v-ea1b047e><div class="info-content" data-v-ea1b047e><h2 class="info-title" data-aos="fade-down" data-aos-delay="600" data-v-ea1b047e>尊享会员特权</h2><ul class="privilege-list" data-v-ea1b047e><li class="privilege-item" data-aos="fade-left" data-aos-delay="700" data-v-ea1b047e><i class="fas fa-crown" data-v-ea1b047e></i><span data-v-ea1b047e>专属会员价格</span></li><li class="privilege-item" data-aos="fade-left" data-aos-delay="800" data-v-ea1b047e><i class="fas fa-gift" data-v-ea1b047e></i><span data-v-ea1b047e>生日专属礼遇</span></li><li class="privilege-item" data-aos="fade-left" data-aos-delay="900" data-v-ea1b047e><i class="fas fa-concierge-bell" data-v-ea1b047e></i><span data-v-ea1b047e>优先预订服务</span></li><li class="privilege-item" data-aos="fade-left" data-aos-delay="1000" data-v-ea1b047e><i class="fas fa-star" data-v-ea1b047e></i><span data-v-ea1b047e>积分奖励计划</span></li></ul></div></div>',1))])])])}}}),Aa=ta($a,[["__scopeId","data-v-ea1b047e"]]);export{Aa as default};
