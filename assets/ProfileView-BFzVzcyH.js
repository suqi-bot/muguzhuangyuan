import{d as B,u as E,a as O,b as u,r as U,o as j,e as q,f as v,g as c,h as m,i as s,l as D,A as G,F as L,k as J,j as b,t as e,p as R,s as x,x as C,w as g,D as y,_ as W}from"./index-vYzfv9NW.js";import{r as w}from"./request-DzKJqaQU.js";import{A as H}from"./aos-CzWz6qMZ.js";const K={class:"profile-page"},Q={class:"animated-background"},X={class:"floating-particles"},Y={class:"profile-main"},Z={class:"profile-container"},ss={class:"profile-content"},as={class:"profile-card","data-aos":"fade-up","data-aos-delay":"200"},ts={class:"profile-header"},ls={class:"avatar-section","data-aos":"zoom-in","data-aos-delay":"400"},es={class:"avatar-container"},is={class:"avatar-frame"},os=["src"],ns={class:"avatar-actions"},ds={class:"user-basic-info","data-aos":"fade-left","data-aos-delay":"600"},rs={class:"user-name-section"},vs={class:"user-name"},cs={class:"user-contact"},us={class:"contact-item"},fs={class:"contact-item"},ps={class:"user-stats"},ms={class:"stat-item"},bs={class:"stat-number"},gs={class:"stat-item"},ys={class:"stat-number"},ws={class:"stat-item"},_s={class:"stat-number"},ks={class:"profile-details"},hs={class:"detail-section","data-aos":"fade-up","data-aos-delay":"300"},Ds={class:"detail-grid"},xs={class:"detail-item","data-aos":"fade-right","data-aos-delay":"400"},Cs={class:"item-content"},Ms={class:"detail-item","data-aos":"fade-right","data-aos-delay":"500"},Ts={class:"item-content"},Is={class:"detail-item","data-aos":"fade-right","data-aos-delay":"600"},Ns={class:"item-content"},$s={class:"detail-item","data-aos":"fade-right","data-aos-delay":"700"},As={class:"item-content"},Ps={class:"detail-item","data-aos":"fade-right","data-aos-delay":"800"},Vs={class:"item-content"},zs={class:"detail-section","data-aos":"fade-up","data-aos-delay":"400"},Fs={class:"detail-grid"},Ss={class:"detail-item","data-aos":"fade-left","data-aos-delay":"500"},Bs={class:"item-content"},Es={class:"detail-item","data-aos":"fade-left","data-aos-delay":"600"},Os={class:"item-content"},Us={class:"detail-item","data-aos":"fade-left","data-aos-delay":"700"},js={class:"item-content"},qs={class:"profile-actions","data-aos":"fade-up","data-aos-delay":"500"},Gs={class:"actions-container"},Ls={class:"modal-header"},Js={class:"modal-body"},Rs={class:"current-avatar-preview"},Ws={class:"preview-container"},Hs=["src"],Ks={class:"upload-section"},Qs={class:"upload-method"},Xs={key:0,class:"upload-progress"},Ys={class:"progress-container"},Zs={class:"progress-bar"},sa={class:"progress-text"},aa={class:"progress-status"},ta={key:0,class:"fas fa-spinner fa-spin"},la={key:1,class:"fas fa-check-circle"},ea={class:"modal-footer"},ia=["disabled"],oa=B({__name:"ProfileView",setup(na){E();const f=O(),_=u(!1),d=u(!1),o=u(0),r=u(""),k=u(),l=U({username:"",realName:"",email:"",phone:"",gender:"",idCard:"",avatar:"",total:0,status:0,createTime:"",loginTime:""}),M=async()=>{_.value=!0;try{const t=await w.get("/h/user/getUserInfo");if(t.code===200||t.code==="200")Object.assign(l,t.data);else throw new Error(t.msg||"获取用户信息失败")}catch(t){console.error("获取用户信息失败:",t),f.user&&Object.assign(l,f.user)}finally{_.value=!1}},p=t=>t?new Date(t).toLocaleString("zh-CN"):"未知",T=t=>{const a=Math.random()*4+2,n=Math.random()*100,i=Math.random()*20,S=Math.random()*10+10;return{width:`${a}px`,height:`${a}px`,left:`${n}%`,animationDelay:`${i}s`,animationDuration:`${S}s`}},I=()=>Math.floor(Math.random()*20)+1,N=()=>{if(!l.createTime)return 0;const t=new Date(l.createTime),n=Math.abs(new Date().getTime()-t.getTime());return Math.ceil(n/(1e3*60*60*24))},$=t=>t?t.length<8?t:t.substring(0,4)+"****"+t.substring(t.length-4):"未设置",A=()=>{alert("修改密码功能开发中...")},P=()=>{k.value?.click()},V=async t=>{const n=t.target.files?.[0];n&&await h(n)},z=async t=>{const a=t.dataTransfer?.files;a&&a.length>0&&await h(a[0])},h=async t=>{if(!t.type.startsWith("image/")){alert("请选择图片文件");return}if(t.size>5*1024*1024){alert("图片大小不能超过5MB");return}try{o.value=0;const a=new FormData;a.append("file",t);const n=setInterval(()=>{o.value<90&&(o.value+=10)},100),i=await w.post("/files/upload",a,{headers:{"Content-Type":"multipart/form-data"}});if(clearInterval(n),o.value=100,i.code===200||i.code==="200")r.value=i.data,setTimeout(()=>{o.value=0},1e3);else throw new Error(i.msg||"上传失败")}catch(a){console.error("头像上传失败:",a),alert("头像上传失败，请稍后重试"),o.value=0}},F=async()=>{if(r.value)try{const t=await w.put("/h/user/updateInfo",{avatar:r.value});if(t.code===200||t.code==="200")l.avatar=r.value,f.user&&(f.user.avatar=r.value),d.value=!1,r.value="",alert("头像更新成功！");else throw new Error(t.msg||"保存失败")}catch(t){console.error("保存头像失败:",t),alert("保存失败，请稍后重试")}};return j(()=>{M(),H.init({duration:800,easing:"ease-out-cubic",once:!0,offset:50})}),(t,a)=>{const n=q("router-link");return c(),v("div",K,[m(G),s("div",Q,[s("div",X,[(c(),v(L,null,J(20,i=>s("div",{class:"particle",key:i,style:y(T())},null,4)),64))]),a[7]||(a[7]=s("div",{class:"gradient-orbs"},[s("div",{class:"orb orb-1"}),s("div",{class:"orb orb-2"}),s("div",{class:"orb orb-3"})],-1))]),s("main",Y,[s("div",Z,[a[49]||(a[49]=b('<div class="page-header" data-aos="fade-down" data-aos-duration="800" data-v-5472848a><div class="header-decoration" data-v-5472848a><div class="decoration-line" data-v-5472848a></div><div class="decoration-icon" data-v-5472848a><i class="fas fa-user-circle" data-v-5472848a></i></div><div class="decoration-line" data-v-5472848a></div></div><h1 class="page-title" data-v-5472848a><span class="title-text" data-v-5472848a>个人中心</span><div class="title-underline" data-v-5472848a></div></h1><p class="page-subtitle" data-v-5472848a>管理您在普洱蘑菇庄园的个人资料</p></div>',1)),s("div",ss,[s("div",as,[a[48]||(a[48]=s("div",{class:"card-decoration"},[s("div",{class:"decoration-pattern"}),s("div",{class:"card-glow"})],-1)),s("div",ts,[s("div",ls,[s("div",es,[s("div",is,[s("img",{src:l.avatar||"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=400&h=400&q=80",alt:"头像",class:"avatar"},null,8,os),a[8]||(a[8]=s("div",{class:"avatar-ring"},null,-1)),a[9]||(a[9]=s("div",{class:"avatar-pulse"},null,-1))]),s("div",{class:"avatar-overlay",onClick:a[0]||(a[0]=i=>d.value=!0)},a[10]||(a[10]=[s("div",{class:"overlay-content"},[s("i",{class:"fas fa-camera"}),s("span",null,"更换头像")],-1)]))]),s("div",ns,[s("button",{class:"change-avatar-btn",onClick:a[1]||(a[1]=i=>d.value=!0)},a[11]||(a[11]=[s("i",{class:"fas fa-edit"},null,-1),s("span",null,"更换头像",-1),s("div",{class:"btn-ripple"},null,-1)]))])]),s("div",ds,[s("div",rs,[s("h2",vs,e(l.realName||l.username),1),a[12]||(a[12]=s("div",{class:"user-badge"},[s("i",{class:"fas fa-crown"}),s("span",null,"VIP会员")],-1))]),s("div",cs,[s("div",us,[a[13]||(a[13]=s("i",{class:"fas fa-phone"},null,-1)),s("span",null,e(l.phone||"未设置手机号"),1)]),s("div",fs,[a[14]||(a[14]=s("i",{class:"fas fa-calendar-alt"},null,-1)),s("span",null,"注册时间："+e(p(l.createTime)),1)])]),s("div",ps,[s("div",ms,[s("div",bs,"¥"+e(l.total||0),1),a[15]||(a[15]=s("div",{class:"stat-label"},"总消费",-1))]),s("div",gs,[s("div",ys,e(I()),1),a[16]||(a[16]=s("div",{class:"stat-label"},"订单数",-1))]),s("div",ws,[s("div",_s,e(N()),1),a[17]||(a[17]=s("div",{class:"stat-label"},"会员天数",-1))])])])]),s("div",ks,[s("div",hs,[a[33]||(a[33]=s("div",{class:"section-header"},[s("div",{class:"section-icon"},[s("i",{class:"fas fa-user"})]),s("h3",null,"基本信息"),s("div",{class:"section-decoration"})],-1)),s("div",Ds,[s("div",xs,[a[19]||(a[19]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-id-card"})],-1)),s("div",Cs,[a[18]||(a[18]=s("label",null,"用户名",-1)),s("span",null,e(l.username),1)]),a[20]||(a[20]=s("div",{class:"item-decoration"},null,-1))]),s("div",Ms,[a[22]||(a[22]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-signature"})],-1)),s("div",Ts,[a[21]||(a[21]=s("label",null,"真实姓名",-1)),s("span",null,e(l.realName||"未设置"),1)]),a[23]||(a[23]=s("div",{class:"item-decoration"},null,-1))]),s("div",Is,[a[25]||(a[25]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-mobile-alt"})],-1)),s("div",Ns,[a[24]||(a[24]=s("label",null,"手机号",-1)),s("span",null,e(l.phone||"未设置"),1)]),a[26]||(a[26]=s("div",{class:"item-decoration"},null,-1))]),s("div",$s,[a[28]||(a[28]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-venus-mars"})],-1)),s("div",As,[a[27]||(a[27]=s("label",null,"性别",-1)),s("span",null,e(l.gender||"未设置"),1)]),a[29]||(a[29]=s("div",{class:"item-decoration"},null,-1))]),s("div",Ps,[a[31]||(a[31]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-address-card"})],-1)),s("div",Vs,[a[30]||(a[30]=s("label",null,"身份证号",-1)),s("span",null,e($(l.idCard)),1)]),a[32]||(a[32]=s("div",{class:"item-decoration"},null,-1))])])]),s("div",zs,[a[44]||(a[44]=s("div",{class:"section-header"},[s("div",{class:"section-icon"},[s("i",{class:"fas fa-shield-alt"})]),s("h3",null,"账户信息"),s("div",{class:"section-decoration"})],-1)),s("div",Fs,[s("div",Ss,[a[35]||(a[35]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-calendar-plus"})],-1)),s("div",Bs,[a[34]||(a[34]=s("label",null,"注册时间",-1)),s("span",null,e(p(l.createTime)),1)]),a[36]||(a[36]=s("div",{class:"item-decoration"},null,-1))]),s("div",Es,[a[38]||(a[38]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-clock"})],-1)),s("div",Os,[a[37]||(a[37]=s("label",null,"最后登录",-1)),s("span",null,e(p(l.loginTime)),1)]),a[39]||(a[39]=s("div",{class:"item-decoration"},null,-1))]),s("div",Us,[a[42]||(a[42]=s("div",{class:"item-icon"},[s("i",{class:"fas fa-check-circle"})],-1)),s("div",js,[a[41]||(a[41]=s("label",null,"账户状态",-1)),s("span",{class:R(["status-badge",l.status===0?"active":"inactive"])},[a[40]||(a[40]=s("div",{class:"status-indicator"},null,-1)),x(" "+e(l.status===0?"正常":"已停用"),1)],2)]),a[43]||(a[43]=s("div",{class:"item-decoration"},null,-1))])])])]),s("div",qs,[s("div",Gs,[m(n,{to:"/edit-profile",class:"btn btn-primary btn-animated"},{default:C(()=>a[45]||(a[45]=[s("div",{class:"btn-icon"},[s("i",{class:"fas fa-edit"})],-1),s("span",{class:"btn-text"},"编辑资料",-1),s("div",{class:"btn-shine"},null,-1),s("div",{class:"btn-ripple"},null,-1)])),_:1,__:[45]}),s("button",{onClick:A,class:"btn btn-outline btn-animated"},a[46]||(a[46]=[b('<div class="btn-icon" data-v-5472848a><i class="fas fa-key" data-v-5472848a></i></div><span class="btn-text" data-v-5472848a>修改密码</span><div class="btn-shine" data-v-5472848a></div><div class="btn-ripple" data-v-5472848a></div>',4)])),m(n,{to:"/orders",class:"btn btn-secondary btn-animated"},{default:C(()=>a[47]||(a[47]=[s("div",{class:"btn-icon"},[s("i",{class:"fas fa-list-alt"})],-1),s("span",{class:"btn-text"},"我的订单",-1),s("div",{class:"btn-shine"},null,-1),s("div",{class:"btn-ripple"},null,-1)])),_:1,__:[47]})])])])])])]),d.value?(c(),v("div",{key:0,class:"modal-overlay",onClick:a[6]||(a[6]=i=>d.value=!1)},[s("div",{class:"modal-content",onClick:a[5]||(a[5]=g(()=>{},["stop"])),"data-aos":"zoom-in","data-aos-duration":"300"},[a[59]||(a[59]=s("div",{class:"modal-decoration"},[s("div",{class:"decoration-pattern"})],-1)),s("div",Ls,[a[51]||(a[51]=s("div",{class:"modal-title-section"},[s("div",{class:"modal-icon"},[s("i",{class:"fas fa-camera"})]),s("h3",null,"更换头像")],-1)),s("button",{class:"close-btn",onClick:a[2]||(a[2]=i=>d.value=!1)},a[50]||(a[50]=[s("i",{class:"fas fa-times"},null,-1),s("div",{class:"close-ripple"},null,-1)]))]),s("div",Js,[s("div",Rs,[s("div",Ws,[s("img",{src:l.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e",alt:"当前头像",class:"preview-img"},null,8,Hs),a[52]||(a[52]=s("div",{class:"preview-frame"},null,-1)),a[53]||(a[53]=s("div",{class:"preview-glow"},null,-1))]),a[54]||(a[54]=s("p",{class:"preview-label"},"当前头像",-1))]),s("div",Ks,[s("div",Qs,[a[56]||(a[56]=s("h4",null,[s("i",{class:"fas fa-upload"}),x(" 上传新头像 ")],-1)),s("div",{class:"file-upload-area",onClick:P,onDragover:a[3]||(a[3]=g(()=>{},["prevent"])),onDrop:g(z,["prevent"])},[s("input",{ref_key:"fileInput",ref:k,type:"file",accept:"image/*",onChange:V,style:{display:"none"}},null,544),a[55]||(a[55]=b('<div class="upload-content" data-v-5472848a><div class="upload-icon" data-v-5472848a><i class="fas fa-cloud-upload-alt" data-v-5472848a></i><div class="upload-pulse" data-v-5472848a></div></div><div class="upload-text" data-v-5472848a><p class="upload-main" data-v-5472848a>点击上传或拖拽图片到此处</p><p class="upload-hint" data-v-5472848a>支持 JPG、PNG 格式，建议尺寸 200x200px，最大5MB</p></div></div>',1))],32),o.value>0?(c(),v("div",Xs,[s("div",Ys,[s("div",Zs,[s("div",{class:"progress-fill",style:y({width:o.value+"%"})},null,4),s("div",{class:"progress-glow",style:y({left:o.value+"%"})},null,4)]),s("span",sa,e(o.value)+"%",1)]),s("div",aa,[o.value<100?(c(),v("i",ta)):(c(),v("i",la)),s("span",null,e(o.value<100?"上传中...":"上传完成"),1)])])):D("",!0)])])]),s("div",ea,[s("button",{class:"btn btn-outline btn-animated",onClick:a[4]||(a[4]=i=>d.value=!1)},a[57]||(a[57]=[s("span",null,"取消",-1),s("div",{class:"btn-ripple"},null,-1)])),s("button",{class:"btn btn-primary btn-animated",onClick:F,disabled:!r.value},a[58]||(a[58]=[s("span",null,"保存头像",-1),s("div",{class:"btn-ripple"},null,-1)]),8,ia)])])])):D("",!0)])}}}),ca=W(oa,[["__scopeId","data-v-5472848a"]]);export{ca as default};
