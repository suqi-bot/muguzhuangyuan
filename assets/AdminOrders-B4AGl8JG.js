import{d as B,u as U,a as q,b as r,r as H,c as E,o as Q,e as W,f as o,g as i,i as t,l as p,h as N,x as D,s as m,t as e,m as w,v as S,M as G,j as J,F as K,k as X,p as $,w as Y,_ as Z}from"./index-vYzfv9NW.js";import{r as g}from"./request-DzKJqaQU.js";const tt={class:"admin-dashboard"},st={class:"sidebar"},lt={class:"sidebar-nav"},et={class:"nav-section"},nt={class:"nav-list"},at={class:"nav-item"},ot={class:"nav-item"},it={class:"nav-item"},dt={class:"main-content"},ut={class:"orders-content"},rt={class:"stats-grid"},ct={class:"stat-card"},mt={class:"stat-info"},vt={class:"stat-card"},pt={class:"stat-info"},ft={class:"stat-card"},bt={class:"stat-info"},_t={class:"stat-card"},ht={class:"stat-info"},gt={class:"filters-section"},kt={class:"search-bar"},yt={class:"filters"},Ct={class:"orders-table-section"},Nt={key:0,class:"loading"},Dt={key:1,class:"table-container"},wt={class:"orders-table"},Ot={class:"order-number"},Tt={class:"customer-info"},xt={class:"customer-name"},St={class:"customer-phone"},$t={class:"room-info"},Mt={class:"room-name"},At={class:"room-type"},It={class:"price"},Lt={class:"action-buttons"},Vt=["onClick"],Pt=["onClick"],Ft=["onClick"],Rt=["onClick"],jt={key:0,class:"modal-body"},zt={class:"detail-section"},Bt={class:"detail-grid"},Ut={class:"detail-item"},qt={class:"detail-item"},Ht={class:"detail-item"},Et={class:"detail-section"},Qt={class:"detail-grid"},Wt={class:"detail-item"},Gt={class:"detail-item"},Jt={class:"detail-item"},Kt={class:"detail-section"},Xt={class:"detail-grid"},Yt={class:"detail-item"},Zt={class:"detail-item"},ts={class:"detail-item"},ss={class:"detail-item"},ls={class:"detail-item"},es={class:"detail-section"},ns={class:"price-breakdown"},as={class:"price-item"},os={class:"price-item total"},is=B({__name:"AdminOrders",setup(ds){const M=U(),A=q(),k=r(!1),u=r([]),f=r(""),b=r(""),_=r(""),y=r(!1),a=r(null),d=H({pending:0,confirmed:0,completed:0,totalRevenue:0}),I=E(()=>{let l=[...u.value];if(f.value){const s=f.value.toLowerCase();l=l.filter(c=>c.orderNumber.toLowerCase().includes(s)||c.customerName.toLowerCase().includes(s))}return b.value&&(l=l.filter(s=>s.status===b.value)),_.value&&(l=l.filter(s=>s.checkInDate.startsWith(_.value))),l}),L=async()=>{k.value=!0;try{const l=await g.get("/admin/orders");u.value=l.data,v()}catch(l){console.error("获取订单列表失败:",l),u.value=[{id:1,orderNumber:"HT202501070001",customerName:"张三",customerPhone:"13800138000",customerIdCard:"110101199001011234",roomName:"豪华海景套房",roomType:"套房",checkInDate:"2025-01-15",checkOutDate:"2025-01-17",nights:2,roomPrice:888,totalAmount:1776,status:"pending",createTime:"2025-01-07 10:30:00"},{id:2,orderNumber:"HT202501070002",customerName:"李四",customerPhone:"13900139000",roomName:"商务标准间",roomType:"标准间",checkInDate:"2025-01-20",checkOutDate:"2025-01-22",nights:2,roomPrice:288,totalAmount:576,status:"confirmed",createTime:"2025-01-07 14:20:00"}],v()}finally{k.value=!1}},v=()=>{d.pending=u.value.filter(l=>l.status==="pending").length,d.confirmed=u.value.filter(l=>l.status==="confirmed").length,d.completed=u.value.filter(l=>l.status==="completed").length,d.totalRevenue=u.value.filter(l=>l.status==="completed").reduce((l,s)=>l+s.totalAmount,0)},O=l=>({pending:"待审核",confirmed:"已确认",completed:"已完成",cancelled:"已取消"})[l]||l,h=l=>new Date(l).toLocaleDateString("zh-CN"),T=l=>new Date(l).toLocaleString("zh-CN"),V=async l=>{if(confirm(`确定要确认订单"${l.orderNumber}"吗？`))try{await g.put(`/admin/orders/${l.id}/confirm`),l.status="confirmed",v(),alert("订单已确认")}catch(s){console.error("确认订单失败:",s),alert("操作失败，请稍后重试")}},P=async l=>{if(confirm(`确定要拒绝订单"${l.orderNumber}"吗？`))try{await g.put(`/admin/orders/${l.id}/reject`),l.status="cancelled",v(),alert("订单已拒绝")}catch(s){console.error("拒绝订单失败:",s),alert("操作失败，请稍后重试")}},F=async l=>{if(confirm(`确定要完成订单"${l.orderNumber}"吗？`))try{await g.put(`/admin/orders/${l.id}/complete`),l.status="completed",v(),alert("订单已完成")}catch(s){console.error("完成订单失败:",s),alert("操作失败，请稍后重试")}},R=l=>{a.value=l,y.value=!0},x=()=>{y.value=!1,a.value=null},j=()=>{alert("导出功能开发中...")},z=()=>{A.logout(),M.push("/login")};return Q(()=>{L()}),(l,s)=>{const c=W("router-link");return i(),o("div",tt,[t("aside",st,[s[8]||(s[8]=t("div",{class:"sidebar-header"},[t("div",{class:"logo"},[t("span",null,"🍄"),t("span",null,"蘑菇庄园管理系统")])],-1)),t("nav",lt,[t("div",et,[s[7]||(s[7]=t("h3",{class:"nav-title"},"主要功能",-1)),t("ul",nt,[t("li",at,[N(c,{to:"/admin",class:"nav-link"},{default:D(()=>s[4]||(s[4]=[t("i",{class:"fas fa-tachometer-alt"},null,-1),t("span",null,"控制台",-1)])),_:1,__:[4]})]),t("li",ot,[N(c,{to:"/admin/rooms",class:"nav-link"},{default:D(()=>s[5]||(s[5]=[t("i",{class:"fas fa-bed"},null,-1),t("span",null,"房间管理",-1)])),_:1,__:[5]})]),t("li",it,[N(c,{to:"/admin/orders",class:"nav-link active"},{default:D(()=>s[6]||(s[6]=[t("i",{class:"fas fa-clipboard-list"},null,-1),t("span",null,"订单管理",-1)])),_:1,__:[6]})])])])])]),t("main",dt,[t("header",{class:"top-header"},[s[11]||(s[11]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},"预订管理"),t("p",{class:"page-subtitle"},"审核和管理所有用户预订")],-1)),t("div",{class:"header-right"},[t("button",{onClick:j,class:"btn btn-outline"},s[9]||(s[9]=[t("i",{class:"fas fa-download"},null,-1),m(" 导出订单 ")])),t("button",{onClick:z,class:"logout-btn"},s[10]||(s[10]=[t("i",{class:"fas fa-right-from-bracket"},null,-1),m(" 退出登录 ")]))])]),t("div",ut,[t("div",rt,[t("div",ct,[s[13]||(s[13]=t("div",{class:"stat-icon pending"},[t("i",{class:"fas fa-clock"})],-1)),t("div",mt,[t("h3",null,e(d.pending),1),s[12]||(s[12]=t("p",null,"待审核订单",-1))])]),t("div",vt,[s[15]||(s[15]=t("div",{class:"stat-icon confirmed"},[t("i",{class:"fas fa-check-circle"})],-1)),t("div",pt,[t("h3",null,e(d.confirmed),1),s[14]||(s[14]=t("p",null,"已确认订单",-1))])]),t("div",ft,[s[17]||(s[17]=t("div",{class:"stat-icon completed"},[t("i",{class:"fas fa-star"})],-1)),t("div",bt,[t("h3",null,e(d.completed),1),s[16]||(s[16]=t("p",null,"已完成订单",-1))])]),t("div",_t,[s[19]||(s[19]=t("div",{class:"stat-icon revenue"},[t("i",{class:"fas fa-dollar-sign"})],-1)),t("div",ht,[t("h3",null,"¥"+e(d.totalRevenue.toLocaleString()),1),s[18]||(s[18]=t("p",null,"总收入",-1))])])]),t("div",gt,[t("div",kt,[s[20]||(s[20]=t("i",{class:"fas fa-search"},null,-1)),w(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>f.value=n),placeholder:"搜索订单号或客户姓名...",class:"search-input"},null,512),[[S,f.value]])]),t("div",yt,[w(t("select",{"onUpdate:modelValue":s[1]||(s[1]=n=>b.value=n),class:"filter-select"},s[21]||(s[21]=[J('<option value="" data-v-1a07c3b6>全部状态</option><option value="pending" data-v-1a07c3b6>待审核</option><option value="confirmed" data-v-1a07c3b6>已确认</option><option value="completed" data-v-1a07c3b6>已完成</option><option value="cancelled" data-v-1a07c3b6>已取消</option>',5)]),512),[[G,b.value]]),w(t("input",{type:"date","onUpdate:modelValue":s[2]||(s[2]=n=>_.value=n),class:"filter-select",placeholder:"选择日期"},null,512),[[S,_.value]])])]),t("div",Ct,[k.value?(i(),o("div",Nt,s[22]||(s[22]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),t("span",null,"加载中...",-1)]))):(i(),o("div",Dt,[t("table",wt,[s[27]||(s[27]=t("thead",null,[t("tr",null,[t("th",null,"订单号"),t("th",null,"客户信息"),t("th",null,"房间信息"),t("th",null,"入住日期"),t("th",null,"退房日期"),t("th",null,"总金额"),t("th",null,"状态"),t("th",null,"下单时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(i(!0),o(K,null,X(I.value,n=>(i(),o("tr",{key:n.id},[t("td",null,[t("div",Ot,e(n.orderNumber),1)]),t("td",null,[t("div",Tt,[t("div",xt,e(n.customerName),1),t("div",St,e(n.customerPhone),1)])]),t("td",null,[t("div",$t,[t("div",Mt,e(n.roomName),1),t("div",At,e(n.roomType),1)])]),t("td",null,e(h(n.checkInDate)),1),t("td",null,e(h(n.checkOutDate)),1),t("td",It,"¥"+e(n.totalAmount),1),t("td",null,[t("span",{class:$(["status-badge",n.status])},e(O(n.status)),3)]),t("td",null,e(T(n.createTime)),1),t("td",null,[t("div",Lt,[n.status==="pending"?(i(),o("button",{key:0,onClick:C=>V(n),class:"btn btn-sm btn-success"},s[23]||(s[23]=[t("i",{class:"fas fa-check"},null,-1),m(" 确认 ")]),8,Vt)):p("",!0),n.status==="pending"?(i(),o("button",{key:1,onClick:C=>P(n),class:"btn btn-sm btn-danger"},s[24]||(s[24]=[t("i",{class:"fas fa-times"},null,-1),m(" 拒绝 ")]),8,Pt)):p("",!0),n.status==="confirmed"?(i(),o("button",{key:2,onClick:C=>F(n),class:"btn btn-sm btn-primary"},s[25]||(s[25]=[t("i",{class:"fas fa-flag-checkered"},null,-1),m(" 完成 ")]),8,Ft)):p("",!0),t("button",{onClick:C=>R(n),class:"btn btn-sm btn-outline"},s[26]||(s[26]=[t("i",{class:"fas fa-eye"},null,-1),m(" 详情 ")]),8,Rt)])])]))),128))])])]))])])]),y.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:x},[t("div",{class:"modal",onClick:s[3]||(s[3]=Y(()=>{},["stop"]))},[t("div",{class:"modal-header"},[s[29]||(s[29]=t("h3",null,"订单详情",-1)),t("button",{onClick:x,class:"close-btn"},s[28]||(s[28]=[t("i",{class:"fas fa-times"},null,-1)]))]),a.value?(i(),o("div",jt,[t("div",zt,[s[33]||(s[33]=t("h4",null,"订单信息",-1)),t("div",Bt,[t("div",Ut,[s[30]||(s[30]=t("label",null,"订单号：",-1)),t("span",null,e(a.value.orderNumber),1)]),t("div",qt,[s[31]||(s[31]=t("label",null,"下单时间：",-1)),t("span",null,e(T(a.value.createTime)),1)]),t("div",Ht,[s[32]||(s[32]=t("label",null,"订单状态：",-1)),t("span",{class:$(["status-badge",a.value.status])},e(O(a.value.status)),3)])])]),t("div",Et,[s[37]||(s[37]=t("h4",null,"客户信息",-1)),t("div",Qt,[t("div",Wt,[s[34]||(s[34]=t("label",null,"姓名：",-1)),t("span",null,e(a.value.customerName),1)]),t("div",Gt,[s[35]||(s[35]=t("label",null,"手机号：",-1)),t("span",null,e(a.value.customerPhone),1)]),t("div",Jt,[s[36]||(s[36]=t("label",null,"身份证：",-1)),t("span",null,e(a.value.customerIdCard||"未提供"),1)])])]),t("div",Kt,[s[43]||(s[43]=t("h4",null,"房间信息",-1)),t("div",Xt,[t("div",Yt,[s[38]||(s[38]=t("label",null,"房间名称：",-1)),t("span",null,e(a.value.roomName),1)]),t("div",Zt,[s[39]||(s[39]=t("label",null,"房间类型：",-1)),t("span",null,e(a.value.roomType),1)]),t("div",ts,[s[40]||(s[40]=t("label",null,"入住日期：",-1)),t("span",null,e(h(a.value.checkInDate)),1)]),t("div",ss,[s[41]||(s[41]=t("label",null,"退房日期：",-1)),t("span",null,e(h(a.value.checkOutDate)),1)]),t("div",ls,[s[42]||(s[42]=t("label",null,"住宿天数：",-1)),t("span",null,e(a.value.nights)+"晚",1)])])]),t("div",es,[s[46]||(s[46]=t("h4",null,"费用明细",-1)),t("div",ns,[t("div",as,[s[44]||(s[44]=t("span",null,"房费：",-1)),t("span",null,"¥"+e(a.value.roomPrice)+" × "+e(a.value.nights)+"晚",1)]),t("div",os,[s[45]||(s[45]=t("span",null,"总计：",-1)),t("span",null,"¥"+e(a.value.totalAmount),1)])])])])):p("",!0)])])):p("",!0)])}}}),cs=Z(is,[["__scopeId","data-v-1a07c3b6"]]);export{cs as default};
