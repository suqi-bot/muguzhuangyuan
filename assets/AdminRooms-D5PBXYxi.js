import{d as O,u as I,a as Q,b as i,r as G,c as H,o as J,e as K,f as d,g as p,i as t,l as P,h as V,x,s as m,m as o,v as c,M as _,j as R,F as W,k as X,t as n,w as U,p as M,_ as Y}from"./index-vYzfv9NW.js";import{r as f}from"./request-DzKJqaQU.js";const Z={class:"admin-dashboard"},tt={class:"sidebar"},st={class:"sidebar-nav"},lt={class:"nav-section"},et={class:"nav-list"},at={class:"nav-item"},ot={class:"nav-item"},nt={class:"nav-item"},it={class:"main-content"},ut={class:"top-header"},rt={class:"header-right"},dt={class:"rooms-content"},pt={class:"filters-section"},ct={class:"search-bar"},vt={class:"filters"},mt={class:"rooms-table-section"},ft={key:0,class:"loading"},bt={key:1,class:"table-container"},gt={class:"rooms-table"},yt=["src","alt"],wt={class:"room-info"},kt={class:"price"},_t={class:"action-buttons"},Ct=["onClick"],ht=["onClick"],Vt=["onClick"],xt={class:"modal-header"},Mt={class:"modal-body"},St={class:"form-group"},Rt={class:"form-group"},Ut={class:"form-row"},$t={class:"form-group"},jt={class:"form-group"},Lt={class:"form-row"},Nt={class:"form-group"},Tt={class:"form-group"},qt={class:"form-group"},Dt=O({__name:"AdminRooms",setup(Ft){const $=I(),j=Q(),C=i(!1),u=i([]),b=i(""),g=i(""),y=i(""),v=i(!1),h=i(!1),w=i(null),a=G({name:"",description:"",type:"",price:0,weight:0,status:0,image:""}),L=H(()=>{let e=[...u.value];if(b.value){const s=b.value.toLowerCase();e=e.filter(r=>r.name.toLowerCase().includes(s)||r.description.toLowerCase().includes(s))}return g.value!==""&&(e=e.filter(s=>s.status.toString()===g.value)),y.value&&(e=e.filter(s=>s.type===y.value)),e}),N=async()=>{C.value=!0;try{const e=await f.get("/h/room?pageNum=1&pageSize=50");if(e.code===200||e.code==="200")u.value=e.data?.records||[];else throw new Error(e.msg||e.message||"获取房间列表失败")}catch{u.value=[{id:1,name:"豪华海景套房",description:"享受无敌海景，配备豪华设施的顶级套房",type:"套房",price:888,status:0,weight:100,image:"/src/assets/images/实地调研/房间参观/房间参观1.jpg",createTime:"2025-01-01 10:00:00"},{id:2,name:"商务标准间",description:"适合商务出行的舒适标准间",type:"标准间",price:288,status:0,weight:80,image:"/src/assets/images/实地调研/房间参观/房间参观2.jpg",createTime:"2025-01-01 11:00:00"}]}finally{C.value=!1}},T=e=>({0:"available",1:"booked",2:"maintenance"})[e]||"available",q=e=>({0:"可用",1:"已预订",2:"维护中"})[e]||"未知",D=e=>new Date(e).toLocaleDateString("zh-CN"),F=e=>{w.value=e,Object.assign(a,e),h.value=!0},A=async e=>{if(confirm(`确定要删除房间"${e.name}"吗？`))try{await f.delete(`/room/${e.id}`),u.value=u.value.filter(s=>s.id!==e.id),alert("删除成功")}catch(s){console.error("删除房间失败:",s),alert("删除失败，请稍后重试")}},z=async e=>{try{const s=e.status===0?2:0;await f.put(`/room/${e.id}/status`,{status:s}),e.status=s,alert(s===0?"房间已上架":"房间已下架")}catch(s){console.error("更新房间状态失败:",s),alert("操作失败，请稍后重试")}},B=async()=>{try{if(v.value){const e=await f.post("/room",a);u.value.push(e.data),alert("添加成功")}else await f.put(`/room/${w.value.id}`,a),Object.assign(w.value,a),alert("更新成功");k()}catch(e){console.error("保存房间失败:",e),alert("保存失败，请稍后重试")}},k=()=>{v.value=!1,h.value=!1,w.value=null,Object.assign(a,{name:"",description:"",type:"",price:0,weight:0,status:0,image:""})},E=()=>{j.logout(),$.push("/login")};return J(()=>{N()}),(e,s)=>{const r=K("router-link");return p(),d("div",Z,[t("aside",tt,[s[16]||(s[16]=t("div",{class:"sidebar-header"},[t("div",{class:"logo"},[t("span",null,"🍄"),t("span",null,"蘑菇庄园管理系统")])],-1)),t("nav",st,[t("div",lt,[s[15]||(s[15]=t("h3",{class:"nav-title"},"主要功能",-1)),t("ul",et,[t("li",at,[V(r,{to:"/admin",class:"nav-link"},{default:x(()=>s[12]||(s[12]=[t("i",{class:"fas fa-tachometer-alt"},null,-1),t("span",null,"控制台",-1)])),_:1,__:[12]})]),t("li",ot,[V(r,{to:"/admin/rooms",class:"nav-link active"},{default:x(()=>s[13]||(s[13]=[t("i",{class:"fas fa-bed"},null,-1),t("span",null,"房间管理",-1)])),_:1,__:[13]})]),t("li",nt,[V(r,{to:"/admin/orders",class:"nav-link"},{default:x(()=>s[14]||(s[14]=[t("i",{class:"fas fa-clipboard-list"},null,-1),t("span",null,"订单管理",-1)])),_:1,__:[14]})])])])])]),t("main",it,[t("header",ut,[s[19]||(s[19]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},"民宿管理"),t("p",{class:"page-subtitle"},"管理庄园民宿信息")],-1)),t("div",rt,[t("button",{onClick:s[0]||(s[0]=l=>v.value=!0),class:"btn btn-primary"},s[17]||(s[17]=[t("i",{class:"fas fa-plus"},null,-1),m(" 添加民宿 ")])),t("button",{onClick:E,class:"logout-btn"},s[18]||(s[18]=[t("i",{class:"fas fa-sign-out-alt"},null,-1),m(" 退出登录 ")]))])]),t("div",dt,[t("div",pt,[t("div",ct,[s[20]||(s[20]=t("i",{class:"fas fa-search"},null,-1)),o(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=l=>b.value=l),placeholder:"搜索房间名称或编号...",class:"search-input"},null,512),[[c,b.value]])]),t("div",vt,[o(t("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>g.value=l),class:"filter-select"},s[21]||(s[21]=[t("option",{value:""},"全部状态",-1),t("option",{value:"0"},"可用",-1),t("option",{value:"1"},"已预订",-1),t("option",{value:"2"},"维护中",-1)]),512),[[_,g.value]]),o(t("select",{"onUpdate:modelValue":s[3]||(s[3]=l=>y.value=l),class:"filter-select"},s[22]||(s[22]=[R('<option value="" data-v-c3ca4a76>全部类型</option><option value="标准间" data-v-c3ca4a76>标准间</option><option value="豪华间" data-v-c3ca4a76>豪华间</option><option value="套房" data-v-c3ca4a76>套房</option><option value="总统套房" data-v-c3ca4a76>总统套房</option>',5)]),512),[[_,y.value]])])]),t("div",mt,[C.value?(p(),d("div",ft,s[23]||(s[23]=[t("i",{class:"fas fa-spinner fa-spin"},null,-1),t("span",null,"加载中...",-1)]))):(p(),d("div",bt,[t("table",gt,[s[26]||(s[26]=t("thead",null,[t("tr",null,[t("th",null,"房间图片"),t("th",null,"房间名称"),t("th",null,"房间类型"),t("th",null,"价格/晚"),t("th",null,"状态"),t("th",null,"权重"),t("th",null,"创建时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(p(!0),d(W,null,X(L.value,l=>(p(),d("tr",{key:l.id},[t("td",null,[t("img",{src:l.image||"/src/assets/images/实地调研/房间参观/房间参观1.jpg",alt:l.name,class:"room-thumbnail"},null,8,yt)]),t("td",null,[t("div",wt,[t("h4",null,n(l.name),1),t("p",null,n(l.description),1)])]),t("td",null,n(l.type),1),t("td",kt,"¥"+n(l.price),1),t("td",null,[t("span",{class:M(["status-badge",T(l.status)])},n(q(l.status)),3)]),t("td",null,n(l.weight||0),1),t("td",null,n(D(l.createTime)),1),t("td",null,[t("div",_t,[t("button",{onClick:S=>F(l),class:"btn btn-sm btn-outline"},s[24]||(s[24]=[t("i",{class:"fas fa-edit"},null,-1),m(" 编辑 ")]),8,Ct),t("button",{onClick:S=>z(l),class:M(["btn btn-sm",l.status===0?"btn-warning":"btn-success"])},[t("i",{class:M(["fas",l.status===0?"fa-pause":"fa-play"])},null,2),m(" "+n(l.status===0?"下架":"上架"),1)],10,ht),t("button",{onClick:S=>A(l),class:"btn btn-sm btn-danger"},s[25]||(s[25]=[t("i",{class:"fas fa-trash"},null,-1),m(" 删除 ")]),8,Vt)])])]))),128))])])]))])])]),v.value||h.value?(p(),d("div",{key:0,class:"modal-overlay",onClick:k},[t("div",{class:"modal",onClick:s[11]||(s[11]=U(()=>{},["stop"]))},[t("div",xt,[t("h3",null,n(v.value?"添加房间":"编辑房间"),1),t("button",{onClick:k,class:"close-btn"},s[27]||(s[27]=[t("i",{class:"fas fa-times"},null,-1)]))]),t("div",Mt,[t("form",{onSubmit:U(B,["prevent"])},[t("div",St,[s[28]||(s[28]=t("label",null,"房间名称",-1)),o(t("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=l=>a.name=l),required:"",class:"form-input"},null,512),[[c,a.name]])]),t("div",Rt,[s[29]||(s[29]=t("label",null,"房间描述",-1)),o(t("textarea",{"onUpdate:modelValue":s[5]||(s[5]=l=>a.description=l),class:"form-textarea"},null,512),[[c,a.description]])]),t("div",Ut,[t("div",$t,[s[31]||(s[31]=t("label",null,"房间类型",-1)),o(t("select",{"onUpdate:modelValue":s[6]||(s[6]=l=>a.type=l),required:"",class:"form-select"},s[30]||(s[30]=[R('<option value="" data-v-c3ca4a76>请选择类型</option><option value="标准间" data-v-c3ca4a76>标准间</option><option value="豪华间" data-v-c3ca4a76>豪华间</option><option value="套房" data-v-c3ca4a76>套房</option><option value="总统套房" data-v-c3ca4a76>总统套房</option>',5)]),512),[[_,a.type]])]),t("div",jt,[s[32]||(s[32]=t("label",null,"价格/晚",-1)),o(t("input",{type:"number","onUpdate:modelValue":s[7]||(s[7]=l=>a.price=l),required:"",class:"form-input"},null,512),[[c,a.price]])])]),t("div",Lt,[t("div",Nt,[s[33]||(s[33]=t("label",null,"权重",-1)),o(t("input",{type:"number","onUpdate:modelValue":s[8]||(s[8]=l=>a.weight=l),class:"form-input"},null,512),[[c,a.weight]])]),t("div",Tt,[s[35]||(s[35]=t("label",null,"状态",-1)),o(t("select",{"onUpdate:modelValue":s[9]||(s[9]=l=>a.status=l),class:"form-select"},s[34]||(s[34]=[t("option",{value:"0"},"可用",-1),t("option",{value:"1"},"已预订",-1),t("option",{value:"2"},"维护中",-1)]),512),[[_,a.status]])])]),t("div",qt,[s[36]||(s[36]=t("label",null,"房间图片URL",-1)),o(t("input",{type:"url","onUpdate:modelValue":s[10]||(s[10]=l=>a.image=l),class:"form-input"},null,512),[[c,a.image]])]),t("div",{class:"modal-actions"},[t("button",{type:"button",onClick:k,class:"btn btn-outline"},"取消"),s[37]||(s[37]=t("button",{type:"submit",class:"btn btn-primary"},"保存",-1))])],32)])])])):P("",!0)])}}}),Bt=Y(Dt,[["__scopeId","data-v-c3ca4a76"]]);export{Bt as default};
