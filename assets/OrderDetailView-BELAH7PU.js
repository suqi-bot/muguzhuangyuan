import{d as B,u as z,M as E,a as L,b as h,o as $,e as j,f as i,g as r,i as s,s as l,h as d,x as c,t as n,N as y,p as D,l as v,_ as G}from"./index-PjnBo1wj.js";import{r as w}from"./request-DzKJqaQU.js";const P={class:"order-detail-page"},U={class:"navbar"},F={class:"nav-container"},H={class:"nav-menu"},J={class:"nav-buttons"},K={class:"user-welcome"},Q={class:"main-content"},W={key:0,class:"loading-container"},X={key:1,class:"order-detail-container"},Y={class:"order-status-section"},Z={class:"status-info"},ss={class:"status-title"},ts={class:"status-desc"},es={class:"order-info-card"},as={class:"info-grid"},os={class:"info-item"},ns={class:"value"},ls={class:"info-item"},is={class:"value"},rs={class:"info-item"},ds={class:"value"},cs={class:"info-item"},us={class:"value"},ms={key:0,class:"special-requirements"},ps={class:"requirements-text"},vs={class:"room-info-card"},fs={class:"room-content"},_s={class:"room-image"},gs=["src","alt"],ks={class:"room-details"},bs={class:"room-name"},hs={class:"room-type"},ys={class:"stay-dates"},Ds={class:"date-item"},ws={class:"date-value"},Ns={class:"date-item"},Cs={class:"date-value"},Ms={class:"nights-info"},Is={class:"cost-detail-card"},Os={class:"cost-breakdown"},Ss={class:"cost-item"},Ts={class:"cost-total"},xs={class:"total-amount"},qs={class:"action-buttons"},Vs={key:2,class:"error-container"},As=B({__name:"OrderDetailView",setup(Rs){const u=z(),f=E(),m=L(),p=h(!0),e=h(null),N=async()=>{p.value=!0;try{const a=f.params.id,t=await w.get("/h/order/getUserOrders");if(t.code===200&&t.data?.records){const o=t.data.records.find(k=>k.id.toString()===a);if(o)e.value={...o,orderNumber:o.orderNumber||`MG${o.id.toString().padStart(8,"0")}`,status:M(o.status),nights:o.nightCount||C(o.checkInDate,o.checkOutDate),roomName:o.roomName||"房间名称",roomType:o.roomType||"房间类型",roomImage:o.roomImage||"/src/assets/images/实地调研/房间参观/房间参观1.jpg"};else throw new Error("订单不存在")}else throw new Error("获取订单详情失败")}catch(a){console.error("获取订单详情失败:",a);const t=f.params.id;e.value={id:t,orderNumber:"MG202501070001",roomName:"蘑菇森林小屋",roomType:"蘑菇小屋",roomImage:"/src/assets/images/实地调研/房间参观/房间参观1.jpg",checkInDate:"2025-01-15",checkOutDate:"2025-01-17",nights:2,roomPrice:388,totalAmount:776,status:"confirmed",createTime:"2025-01-07 10:30:00",guestCount:2,phone:"13800138000",specialRequirements:"希望安排安静的房间，谢谢！"}}finally{p.value=!1}},C=(a,t)=>{if(!a||!t)return 0;const o=new Date(a),R=new Date(t).getTime()-o.getTime(),b=Math.ceil(R/(1e3*60*60*24));return b>0?b:0},M=a=>({0:"pending",1:"confirmed",2:"completed",3:"cancelled",pending:"pending",confirmed:"confirmed",completed:"completed",cancelled:"cancelled"})[a]||"pending",I=a=>({pending:"待确认",confirmed:"已确认",completed:"已完成",cancelled:"已取消"})[a]||a,O=a=>({pending:"fas fa-clock",confirmed:"fas fa-check-circle",completed:"fas fa-flag-checkered",cancelled:"fas fa-times-circle"})[a]||"fas fa-question-circle",S=a=>({pending:"您的订单正在等待管理员确认，请耐心等待",confirmed:"您的订单已确认，请按时入住",completed:"您的订单已完成，感谢您的入住",cancelled:"订单已取消"})[a]||"",_=a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",weekday:"short"}),T=a=>new Date(a).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),x=async()=>{if(confirm("确定要取消这个订单吗？"))try{const a=await w.delete(`/h/order/${e.value.id}`);a.code===200?(e.value.status="cancelled",alert("订单已取消")):alert(a.msg||"取消订单失败")}catch(a){console.error("取消订单失败:",a),alert("取消订单失败，请稍后重试")}},q=()=>{u.push(`/order/${e.value.id}/rate`)},V=()=>{alert("客服功能开发中，如有问题请拨打客服电话：400-123-4567")},g=()=>{u.push("/orders")},A=()=>{m.logout(),u.push("/login")};return $(()=>{N()}),(a,t)=>{const o=j("router-link");return r(),i("div",P,[s("nav",U,[s("div",F,[t[6]||(t[6]=s("div",{class:"logo"},[s("i",{class:"fas fa-seedling"}),l(" 普洱蘑菇庄园 ")],-1)),s("div",H,[d(o,{to:"/",class:"nav-link"},{default:c(()=>t[0]||(t[0]=[l("首页")])),_:1,__:[0]}),d(o,{to:"/tea-culture",class:"nav-link"},{default:c(()=>t[1]||(t[1]=[l("茶文化")])),_:1,__:[1]}),d(o,{to:"/products",class:"nav-link"},{default:c(()=>t[2]||(t[2]=[l("民宿产品")])),_:1,__:[2]}),d(o,{to:"/ai-rooms",class:"nav-link"},{default:c(()=>t[3]||(t[3]=[l("AI选房")])),_:1,__:[3]}),d(o,{to:"/orders",class:"nav-link"},{default:c(()=>t[4]||(t[4]=[l("订单")])),_:1,__:[4]}),d(o,{to:"/profile",class:"nav-link"},{default:c(()=>t[5]||(t[5]=[l("个人信息")])),_:1,__:[5]})]),s("div",J,[s("span",K,"欢迎，"+n(y(m).user?.realName||y(m).user?.username),1),s("button",{onClick:A,class:"btn btn-outline"},"退出登录")])])]),s("main",Q,[p.value?(r(),i("div",W,t[7]||(t[7]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),s("span",null,"加载中...",-1)]))):e.value?(r(),i("div",X,[s("div",{class:"back-section"},[s("button",{onClick:g,class:"back-btn"},t[8]||(t[8]=[s("i",{class:"fas fa-arrow-left"},null,-1),l(" 返回订单列表 ")]))]),s("div",Y,[s("div",{class:D(["status-icon",e.value.status])},[s("i",{class:D(O(e.value.status))},null,2)],2),s("div",Z,[s("h2",ss,n(I(e.value.status)),1),s("p",ts,n(S(e.value.status)),1)])]),s("div",es,[t[14]||(t[14]=s("h3",null,"订单信息",-1)),s("div",as,[s("div",os,[t[9]||(t[9]=s("span",{class:"label"},"订单号：",-1)),s("span",ns,n(e.value.orderNumber),1)]),s("div",ls,[t[10]||(t[10]=s("span",{class:"label"},"下单时间：",-1)),s("span",is,n(T(e.value.createTime)),1)]),s("div",rs,[t[11]||(t[11]=s("span",{class:"label"},"联系电话：",-1)),s("span",ds,n(e.value.phone),1)]),s("div",cs,[t[12]||(t[12]=s("span",{class:"label"},"入住人数：",-1)),s("span",us,n(e.value.guestCount)+"人",1)])]),e.value.specialRequirements?(r(),i("div",ms,[t[13]||(t[13]=s("span",{class:"label"},"特殊要求：",-1)),s("p",ps,n(e.value.specialRequirements),1)])):v("",!0)]),s("div",vs,[t[21]||(t[21]=s("h3",null,"房间信息",-1)),s("div",fs,[s("div",_s,[s("img",{src:e.value.roomImage||"/api/placeholder/300/200",alt:e.value.roomName},null,8,gs)]),s("div",ks,[s("h4",bs,n(e.value.roomName),1),s("p",hs,n(e.value.roomType),1),s("div",ys,[s("div",Ds,[t[16]||(t[16]=s("i",{class:"fas fa-calendar-check"},null,-1)),s("div",null,[t[15]||(t[15]=s("span",{class:"date-label"},"入住日期",-1)),s("span",ws,n(_(e.value.checkInDate)),1)])]),t[19]||(t[19]=s("div",{class:"date-separator"},[s("i",{class:"fas fa-arrow-right"})],-1)),s("div",Ns,[t[18]||(t[18]=s("i",{class:"fas fa-calendar-times"},null,-1)),s("div",null,[t[17]||(t[17]=s("span",{class:"date-label"},"退房日期",-1)),s("span",Cs,n(_(e.value.checkOutDate)),1)])])]),s("div",Ms,[t[20]||(t[20]=s("i",{class:"fas fa-moon"},null,-1)),s("span",null,"共 "+n(e.value.nights)+" 晚",1)])])])]),s("div",Is,[t[23]||(t[23]=s("h3",null,"费用明细",-1)),s("div",Os,[s("div",Ss,[s("span",null,"房费 ("+n(e.value.nights)+"晚 × ¥"+n(e.value.roomPrice)+")",1),s("span",null,"¥"+n(e.value.totalAmount),1)]),s("div",Ts,[t[22]||(t[22]=s("span",null,"总计",-1)),s("span",xs,"¥"+n(e.value.totalAmount),1)])])]),s("div",qs,[e.value.status==="pending"?(r(),i("button",{key:0,onClick:x,class:"btn btn-danger"},t[24]||(t[24]=[s("i",{class:"fas fa-times"},null,-1),l(" 取消订单 ")]))):v("",!0),e.value.status==="completed"?(r(),i("button",{key:1,onClick:q,class:"btn btn-primary"},t[25]||(t[25]=[s("i",{class:"fas fa-star"},null,-1),l(" 评价订单 ")]))):v("",!0),s("button",{onClick:V,class:"btn btn-outline"},t[26]||(t[26]=[s("i",{class:"fas fa-headset"},null,-1),l(" 联系客服 ")]))])])):(r(),i("div",Vs,[t[27]||(t[27]=s("i",{class:"fas fa-exclamation-triangle"},null,-1)),t[28]||(t[28]=s("h3",null,"订单不存在",-1)),t[29]||(t[29]=s("p",null,"抱歉，您查看的订单不存在或已被删除",-1)),s("button",{onClick:g,class:"btn btn-primary"},"返回订单列表")]))])])}}}),Es=G(As,[["__scopeId","data-v-991b05f3"]]);export{Es as default};
