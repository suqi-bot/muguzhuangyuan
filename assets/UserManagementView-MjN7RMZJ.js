import{d as A,b as u,r as N,o as H,f as o,g as i,i as s,l as y,s as v,F as x,k as V,m as z,M as J,j as O,v as Q,G as R,t as l,w as B,p,_ as W}from"./index-vYzfv9NW.js";import{r as $}from"./request-DzKJqaQU.js";const X={class:"user-management"},Y={class:"toolbar"},Z={class:"toolbar-left"},ss={class:"filter-tabs"},ts=["onClick"],as={class:"toolbar-right"},es={class:"search-box"},ls={class:"stats-cards"},ns={class:"stat-card"},os={class:"stat-content"},is={class:"stat-card"},rs={class:"stat-content"},ds={class:"stat-card"},cs={class:"stat-content"},us={class:"stat-card"},vs={class:"stat-content"},fs={class:"user-list"},ps={class:"list-header"},ms={class:"list-controls"},bs={class:"total-count"},gs={key:0,class:"loading"},hs={key:1,class:"user-table"},ys={class:"user-info"},_s={class:"user-basic"},ks={class:"avatar"},ws=["src","alt"],Cs={key:1,class:"fas fa-user"},$s={class:"user-details"},Ss={class:"username"},Ds={class:"user-id"},Ts={class:"contact-info"},Ms={class:"contact-details"},Us={class:"phone"},Ns={class:"email"},xs={class:"identity-info"},Vs={class:"identity-details"},zs={class:"gender"},Bs={class:"id-card"},Fs={class:"address"},Ks={class:"date-info"},Ps={class:"date-info"},Es={class:"actions"},Is=["onClick"],Ls=["onClick"],js=["onClick"],qs=["onClick"],Gs={key:0,class:"empty-state"},As={key:2,class:"pagination"},Hs=["disabled"],Js={class:"page-info"},Os=["disabled"],Qs=A({__name:"UserManagementView",setup(Rs){const r={success:(a,t)=>{console.log(`✅ ${t||"成功"}: ${a}`),alert(`✅ ${a}`)},error:(a,t)=>{console.error(`❌ ${t||"错误"}: ${a}`),alert(`❌ ${a}`)},warning:(a,t)=>{console.warn(`⚠️ ${t||"警告"}: ${a}`),alert(`⚠️ ${a}`)},info:(a,t)=>{console.info(`ℹ️ ${t||"信息"}: ${a}`),alert(`ℹ️ ${a}`)}},_=u(!1),d=u([]),m=u(""),b=u(""),S=u(""),k=u(!1),w=u(!1),C=u(null),F=[{label:"全部",value:""},{label:"正常",value:"0"},{label:"禁用",value:"1"}],n=N({current:1,size:10,total:0,pages:0}),c=N({total:0,active:0,inactive:0,newToday:0}),f=async()=>{_.value=!0;try{const a=await $.get("/sys/user",{params:{pageNum:n.current,pageSize:n.size,search:m.value,searchType:b.value}});a.code===200||a.code==="200"?(d.value=a.data?.records||[],n.total=a.data?.total||0,n.pages=a.data?.pages||0,D(),r.success("用户数据加载成功","数据加载")):r.error(a.message||a.msg||"获取用户列表失败","加载失败")}catch(a){console.error("获取用户列表失败:",a),r.error("网络错误，请稍后重试","加载失败")}finally{_.value=!1}},D=()=>{c.total=d.value.length,c.active=d.value.filter(t=>t.status===0).length,c.inactive=d.value.filter(t=>t.status===1).length;const a=new Date().toDateString();c.newToday=d.value.filter(t=>t.createTime?new Date(t.createTime).toDateString()===a:!1).length},K=a=>{S.value=a,m.value=a,b.value="status",n.current=1,f()},T=()=>{n.current=1,f()},P=()=>{f()},M=a=>{n.current=a,f()},E=a=>{C.value=a,k.value=!0},I=a=>{C.value=a,w.value=!0},L=async a=>{try{const t=a.status===0?1:0,e=await $.put("/sys/user/status",{id:a.id,status:t});e.code===200||e.code==="200"?(a.status=t,D(),r.success(t===0?"用户已启用":"用户已禁用","状态更新")):r.error(e.message||e.msg||"状态更新失败","操作失败")}catch(t){console.error("切换用户状态失败:",t),r.error("网络错误，请稍后重试","操作失败")}},j=async a=>{if(confirm(`确定要重置用户"${a.username}"的密码吗？`))try{const t=await $.post("/h/user/resetPassword",{phone:a.phone,username:a.username});t.code===200||t.code==="200"?r.success(`密码重置成功，新密码为：${t.data}`,"重置成功"):r.error(t.message||t.msg||"重置密码失败","操作失败")}catch(t){console.error("重置密码失败:",t),r.error("网络错误，请稍后重试","重置失败")}},g=()=>{k.value=!1,w.value=!1,C.value=null},q=a=>{switch(a){case 0:return"active";case 1:return"inactive";default:return"unknown"}},G=a=>{switch(a){case 0:return"正常";case 1:return"禁用";default:return"未知"}},U=a=>a?new Date(a).toLocaleDateString("zh-CN"):"-";return H(()=>{f()}),(a,t)=>(i(),o("div",X,[t[34]||(t[34]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},[s("i",{class:"fas fa-users"}),v(" 用户管理 ")]),s("p",{class:"page-description"},"管理普洱蘑菇庄园民宿的所有用户信息")],-1)),s("div",Y,[s("div",Z,[s("button",{onClick:P,class:"btn btn-secondary"},t[6]||(t[6]=[s("i",{class:"fas fa-sync-alt"},null,-1),v(" 刷新 ")])),s("div",ss,[(i(),o(x,null,V(F,e=>s("button",{key:e.value,onClick:h=>K(e.value),class:p(["tab-btn",{active:S.value===e.value}])},l(e.label),11,ts)),64))])]),s("div",as,[s("div",es,[z(s("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),class:"search-type"},t[7]||(t[7]=[O('<option value="" data-v-93065f77>全部</option><option value="username" data-v-93065f77>用户名</option><option value="realName" data-v-93065f77>真实姓名</option><option value="phonenumber" data-v-93065f77>手机号</option><option value="email" data-v-93065f77>邮箱</option>',5)]),512),[[J,b.value]]),z(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),onKeyup:R(T,["enter"]),type:"text",placeholder:"搜索用户...",class:"search-input"},null,544),[[Q,m.value]]),s("button",{onClick:T,class:"btn btn-search"},t[8]||(t[8]=[s("i",{class:"fas fa-search"},null,-1)]))])])]),s("div",ls,[s("div",ns,[t[10]||(t[10]=s("div",{class:"stat-icon"},[s("i",{class:"fas fa-users"})],-1)),s("div",os,[s("h3",null,l(c.total),1),t[9]||(t[9]=s("p",null,"总用户数",-1))])]),s("div",is,[t[12]||(t[12]=s("div",{class:"stat-icon active"},[s("i",{class:"fas fa-user-check"})],-1)),s("div",rs,[s("h3",null,l(c.active),1),t[11]||(t[11]=s("p",null,"活跃用户",-1))])]),s("div",ds,[t[14]||(t[14]=s("div",{class:"stat-icon inactive"},[s("i",{class:"fas fa-user-times"})],-1)),s("div",cs,[s("h3",null,l(c.inactive),1),t[13]||(t[13]=s("p",null,"禁用用户",-1))])]),s("div",us,[t[16]||(t[16]=s("div",{class:"stat-icon new"},[s("i",{class:"fas fa-user-plus"})],-1)),s("div",vs,[s("h3",null,l(c.newToday),1),t[15]||(t[15]=s("p",null,"今日新增",-1))])])]),s("div",fs,[s("div",ps,[t[17]||(t[17]=s("h2",null,"用户列表",-1)),s("div",ms,[s("span",bs,"共 "+l(n.total)+" 个用户",1)])]),_.value?(i(),o("div",gs,t[18]||(t[18]=[s("i",{class:"fas fa-spinner fa-spin"},null,-1),v(" 加载中... ")]))):(i(),o("div",hs,[s("table",null,[t[24]||(t[24]=s("thead",null,[s("tr",null,[s("th",null,"用户信息"),s("th",null,"联系方式"),s("th",null,"身份信息"),s("th",null,"注册时间"),s("th",null,"最后登录"),s("th",null,"状态"),s("th",null,"操作")])],-1)),s("tbody",null,[(i(!0),o(x,null,V(d.value,e=>(i(),o("tr",{key:e.id,class:"user-row"},[s("td",ys,[s("div",_s,[s("div",ks,[e.avatar?(i(),o("img",{key:0,src:e.avatar,alt:e.realName},null,8,ws)):(i(),o("i",Cs))]),s("div",$s,[s("h4",null,l(e.realName||e.username),1),s("p",Ss,"@"+l(e.username),1),s("p",Ds,"ID: "+l(e.id),1)])])]),s("td",Ts,[s("div",Ms,[s("p",Us,[t[19]||(t[19]=s("i",{class:"fas fa-phone"},null,-1)),v(" "+l(e.phonenumber||"-"),1)]),s("p",Ns,[t[20]||(t[20]=s("i",{class:"fas fa-envelope"},null,-1)),v(" "+l(e.email||"-"),1)])])]),s("td",xs,[s("div",Vs,[s("p",zs,[s("i",{class:p(e.gender==="男"?"fas fa-mars":"fas fa-venus")},null,2),v(" "+l(e.gender||"-"),1)]),s("p",Bs,l(e.idCard||"-"),1),s("p",Fs,l(e.address||"-"),1)])]),s("td",Ks,l(U(e.createTime)),1),s("td",Ps,l(U(e.loginDate)),1),s("td",null,[s("span",{class:p(["status-badge",q(e.status)])},l(G(e.status)),3)]),s("td",Es,[s("button",{onClick:h=>E(e),class:"btn btn-sm btn-info"},t[21]||(t[21]=[s("i",{class:"fas fa-eye"},null,-1)]),8,Is),s("button",{onClick:h=>I(e),class:"btn btn-sm btn-warning"},t[22]||(t[22]=[s("i",{class:"fas fa-edit"},null,-1)]),8,Ls),s("button",{onClick:h=>L(e),class:p(["btn btn-sm",e.status===0?"btn-danger":"btn-success"])},[s("i",{class:p(e.status===0?"fas fa-ban":"fas fa-check")},null,2)],10,js),s("button",{onClick:h=>j(e),class:"btn btn-sm btn-secondary"},t[23]||(t[23]=[s("i",{class:"fas fa-key"},null,-1)]),8,qs)])]))),128))])]),d.value.length===0?(i(),o("div",Gs,t[25]||(t[25]=[s("i",{class:"fas fa-users"},null,-1),s("h3",null,"暂无用户数据",-1),s("p",null,"当前筛选条件下没有找到用户",-1)]))):y("",!0)])),d.value.length>0?(i(),o("div",As,[s("button",{onClick:t[2]||(t[2]=e=>M(n.current-1)),disabled:n.current<=1,class:"btn btn-secondary"},t[26]||(t[26]=[s("i",{class:"fas fa-chevron-left"},null,-1),v(" 上一页 ")]),8,Hs),s("span",Js," 第 "+l(n.current)+" 页，共 "+l(n.pages)+" 页 ",1),s("button",{onClick:t[3]||(t[3]=e=>M(n.current+1)),disabled:n.current>=n.pages,class:"btn btn-secondary"},t[27]||(t[27]=[v(" 下一页 "),s("i",{class:"fas fa-chevron-right"},null,-1)]),8,Os)])):y("",!0)]),k.value?(i(),o("div",{key:0,class:"modal-overlay",onClick:g},[s("div",{class:"modal modal-large",onClick:t[4]||(t[4]=B(()=>{},["stop"]))},[s("div",{class:"modal-header"},[t[29]||(t[29]=s("h3",null,"用户详情",-1)),s("button",{onClick:g,class:"close-btn"},t[28]||(t[28]=[s("i",{class:"fas fa-times"},null,-1)]))]),t[30]||(t[30]=s("div",{class:"modal-body"},[s("p",null,"用户详情功能开发中...")],-1))])])):y("",!0),w.value?(i(),o("div",{key:1,class:"modal-overlay",onClick:g},[s("div",{class:"modal",onClick:t[5]||(t[5]=B(()=>{},["stop"]))},[s("div",{class:"modal-header"},[t[32]||(t[32]=s("h3",null,"编辑用户",-1)),s("button",{onClick:g,class:"close-btn"},t[31]||(t[31]=[s("i",{class:"fas fa-times"},null,-1)]))]),t[33]||(t[33]=s("div",{class:"modal-body"},[s("p",null,"用户编辑功能开发中...")],-1))])])):y("",!0)]))}}),Ys=W(Qs,[["__scopeId","data-v-93065f77"]]);export{Ys as default};
